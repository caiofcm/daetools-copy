<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8.6. Sensitivity Analysis Examples &#8212; DAE Tools 1.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/[d][a][e].ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8.7. OpenCS Examples" href="tutorials-opencs.html" />
    <link rel="prev" title="8.5. Chemical Engineering Examples" href="tutorials-chemeng.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/[d][a][e]_Tools_project.png"></span>
          DAE Tools</a>
        <span class="navbar-text navbar-version pull-left"><b>1.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/">Home</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="paradigms.html">2. Programming Paradigms</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_daetools.html">4. Getting DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">5. Getting Started with DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_user_guide.html">6. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_api_ref.html">7. API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">8. Tutorials</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">8.6. Sensitivity Analysis Examples</a><ul>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_1">8.6.1. Sensitivity Analysis Example 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_2">8.6.2. Sensitivity Analysis Example 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_3">8.6.3. Sensitivity Analysis Example 3</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="sensitivity-analysis-examples">
<h1>8.6. Sensitivity Analysis Examples<a class="headerlink" href="#sensitivity-analysis-examples" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-sa-1"><span class="std std-ref">Sensitivity Analysis Example 1</span></a></td>
<td>Calculation of the sensitivity of the results with respect to the model
parameters using forward sensitivity analysis method.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="tutorials-all.html#tutorial-sa-2"><span class="std std-ref">Sensitivity Analysis Example 2</span></a></td>
<td>The local derivative-based sensitivity analysis method.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-sa-3"><span class="std std-ref">Sensitivity Analysis Example 3</span></a></td>
<td>The global screening (Morris) and variance-based sensitivity analysis
methods (FAST, Sobol) available in the SALib python software.</td>
</tr>
</tbody>
</table>
<div class="section" id="module-daetools.examples.tutorial_sa_1">
<span id="sensitivity-analysis-example-1"></span><span id="tutorial-sa-1"></span><h2>8.6.1. Sensitivity Analysis Example 1<a class="headerlink" href="#module-daetools.examples.tutorial_sa_1" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates calculation of the sensitivity of the results with respect
to the model parameters using forward sensitivity analysis method in DAE Tools.</p>
<p>This model has one state variable (T) and one degree of freedom (Qin).
Qin is set as a parameter for sensitivity analysis.</p>
<p>The integration of sensitivities per specified parameters is enabled and the 
sensitivities can be reported to the data reporter like any ordinary variable by 
setting the boolean property simulation.ReportSensitivities to True.</p>
<p>Raw sensitivity matrices can be saved into a specified directory using the 
simulation.SensitivityDataDirectory property (before a call to Initialize).
The sensitivity matrics are saved in .mmx coordinate format where the first
dimensions is Nparameters and second Nvariables: S[Np, Nvars].</p>
<p>The plot of the sensitivity of T per Qin:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_1-results.png"><img alt="_images/tutorial_sa_1-results.png" src="_images/tutorial_sa_1-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_sa_1.xml">tutorial_sa_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_sa_1-rt.xml">tutorial_sa_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_sa_1.html">tutorial_sa_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_sa_2">
<span id="sensitivity-analysis-example-2"></span><span id="tutorial-sa-2"></span><h2>8.6.2. Sensitivity Analysis Example 2<a class="headerlink" href="#module-daetools.examples.tutorial_sa_2" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the local derivative-based sensitivity analysis method 
available in DAE Tools.</p>
<p>The problem is adopted from the section 2.1 of the following article:</p>
<ul class="simple">
<li>A. Saltelli, M. Ratto, S. Tarantola, F. Campolongo.
Sensitivity Analysis for Chemical Models. Chem. Rev. (2005), 105(7):2811-2828.
<a class="reference external" href="http://dx.doi.org/10.1021/cr040659d">doi:10.1021/cr040659d</a></li>
</ul>
<p>The model is very simple and describes a simple reversible chemical reaction A &lt;-&gt; B, 
with reaction rates k1 and k_1 for the direct and inverse reactions, respectively.
The reaction rates are uncertain and are described by continuous random variables 
with known probability density functions. The standard deviation is 0.3 for k1 and
1 for k_1. The standard deviation of the concentration of the species A is
approximated using the following expression defined in the article:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>stddev(Ca)**2 = stddev(k1)**2 * (dCa/dk1)**2 + stddev(k_1)**2 * (dCa/dk_1)**2
</pre></div>
</div>
<p>The following derivative-based measures are used in the article:</p>
<ul>
<li><p class="first">Derivatives dCa/dk1 and dCa/dk_1 calculated using the forward sensitivity method</p>
</li>
<li><p class="first">Sigma normalised derivatives:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>S(k1)  = stddev(k1) / stddev(Ca) * dCa/dk1
S(k_1) = stddev(k_1)/ stddev(Ca) * dCa/dk_1
</pre></div>
</div>
</li>
</ul>
<p>The plot of the concentrations, derivatives and sigma normalised derivatives:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_2-results.png"><img alt="_images/tutorial_sa_2-results.png" src="_images/tutorial_sa_2-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_sa_2.xml">tutorial_sa_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_sa_2-rt.xml">tutorial_sa_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_sa_2.html">tutorial_sa_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_sa_3">
<span id="sensitivity-analysis-example-3"></span><span id="tutorial-sa-3"></span><h2>8.6.3. Sensitivity Analysis Example 3<a class="headerlink" href="#module-daetools.examples.tutorial_sa_3" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the global variance-based sensitivity analysis methods
available in the <a class="reference external" href="https://github.com/SALib/SALib">SALib</a> python library.</p>
<p>The problem is adopted from the section 2.6 of the following article:</p>
<ul class="simple">
<li>A. Saltelli, M. Ratto, S. Tarantola, F. Campolongo.
Sensitivity Analysis for Chemical Models. Chem. Rev. (2005), 105(7):2811-2828.
<a class="reference external" href="http://dx.doi.org/10.1021/cr040659d">doi:10.1021/cr040659d</a></li>
</ul>
<p>The model describes a thermal analysis of a batch reactor, with exothermic 
reaction A -&gt; B. The model equations are written in dimensionless form.</p>
<p>Three global sensitivity analysis methods available in SALib are applied:</p>
<ul class="simple">
<li>Morris (Elementary Effect/Screening method)</li>
<li>Sobol (Variance-based methods)</li>
<li>FAST (Variance-based methods)</li>
</ul>
<p>Results from the sensitivity analysis:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>-------------------------------------------------------
       Morris (N = 510)
-------------------------------------------------------
    Param          mu        mu*   mu*_conf      Sigma
        B    0.367412   0.367412   0.114161   0.546276
    gamma   -0.040556   0.056616   0.021330   0.111878
      psi    0.311563   0.311563   0.103515   0.504398
  theta_a    0.326932   0.326932   0.102303   0.490423
  theta_0    0.021208   0.023524   0.016015   0.074062
-------------------------------------------------------

-------------------------------------------------------
       Sobol (N = 6144)
-------------------------------------------------------
    Param          S1    S1_conf         ST    ST_conf
        B    0.094110   0.078918   0.581930   0.154737
    gamma   -0.002416   0.012178   0.044354   0.027352
      psi    0.171043   0.087782   0.524579   0.142115
  theta_a    0.072535   0.042848   0.523394   0.165736
  theta_0    0.002340   0.004848   0.008173   0.005956

Parameter pairs          S2    S2_conf
        B/gamma    0.180427   0.160979
          B/psi    0.260689   0.171367
      B/theta_a    0.143261   0.154060
      B/theta_0    0.177129   0.156582
      gamma/psi    0.000981   0.027443
  gamma/theta_a    0.004956   0.036554
  gamma/theta_0   -0.009392   0.027390
    psi/theta_a    0.166155   0.172727
    psi/theta_0   -0.016434   0.129177
theta_a/theta_0    0.109057   0.127287
-------------------------------------------------------

---------------------------------
       FAST (N = 6150)
---------------------------------
    Param          S1         ST
        B    0.135984   0.559389
    gamma    0.000429   0.029026
      psi    0.171291   0.602461
  theta_a    0.144617   0.534116
  theta_0    0.000248   0.040741
---------------------------------
</pre></div>
</div>
<p>The scatter plot for the Morris method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_morris.png"><img alt="_images/tutorial_sa_3-scatter_morris.png" src="_images/tutorial_sa_3-scatter_morris.png" style="width: 800px;" /></a>
<p>The scatter plot for the Sobol method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_sobol.png"><img alt="_images/tutorial_sa_3-scatter_sobol.png" src="_images/tutorial_sa_3-scatter_sobol.png" style="width: 800px;" /></a>
<p>The scatter plot for the FAST method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_fast.png"><img alt="_images/tutorial_sa_3-scatter_fast.png" src="_images/tutorial_sa_3-scatter_fast.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_sa_3.xml">tutorial_sa_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_sa_3-rt.xml">tutorial_sa_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_sa_3.html">tutorial_sa_3.py</a></td>
</tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/tutorials-sa.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2008-2019, Dragan Nikolic.<br/>
      Last updated on Mar 29, 2019.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52277546-1', 'daetools.com');
  ga('send', 'pageview');
</script>


  </body>
</html>