<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8.5. Chemical Engineering Examples &#8212; DAE Tools 1.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/[d][a][e].ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8.6. Sensitivity Analysis Examples" href="tutorials-sa.html" />
    <link rel="prev" title="8.4. Finite Element Tutorials" href="tutorials-fe.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/[d][a][e]_Tools_project.png"></span>
          DAE Tools</a>
        <span class="navbar-text navbar-version pull-left"><b>1.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/">Home</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="paradigms.html">2. Programming Paradigms</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_daetools.html">4. Getting DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">5. Getting Started with DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_user_guide.html">6. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_api_ref.html">7. API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">8. Tutorials</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">8.5. Chemical Engineering Examples</a><ul>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_1">8.5.1. Chem. Eng. Example 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_2">8.5.2. Chem. Eng. Example 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_3">8.5.3. Chem. Eng. Example 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_4">8.5.4. Chem. Eng. Example 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_5">8.5.5. Chem. Eng. Example 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_6">8.5.6. Chem. Eng. Example 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_7">8.5.7. Chem. Eng. Example 7</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_8">8.5.8. Chem. Eng. Example 8</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_9">8.5.9. Chem. Eng. Example 9</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="chemical-engineering-examples">
<h1>8.5. Chemical Engineering Examples<a class="headerlink" href="#chemical-engineering-examples" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-1"><span class="std std-ref">Chem. Eng. Example 1</span></a></td>
<td>Continuously Stirred Tank Reactor (CSTR) with energy balance and Van de Vusse reactions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-2"><span class="std std-ref">Chem. Eng. Example 2</span></a></td>
<td>Binary distillation column model.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-3"><span class="std std-ref">Chem. Eng. Example 3</span></a></td>
<td>Batch reactor seeded crystallisation using the method of moments.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-4"><span class="std std-ref">Chem. Eng. Example 4</span></a></td>
<td>Solution of a discretized population balance using high resolution upwind schemes with flux limiter.
Effect of flux limiters on the quality of prediction (Case I).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-5"><span class="std std-ref">Chem. Eng. Example 5</span></a></td>
<td>Solution of a discretized population balance using high resolution upwind schemes with flux limiter.
Effect of flux limiters on the quality of prediction (Case II).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-6"><span class="std std-ref">Chem. Eng. Example 6</span></a></td>
<td>Model of a lithium-ion battery based on porous electrode theory as developed by John Newman and coworkers.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-7"><span class="std std-ref">Chem. Eng. Example 7</span></a></td>
<td>Steady-state Plug Flow Reactor (PFR) with energy balance and first order reaction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-8"><span class="std std-ref">Chem. Eng. Example 8</span></a></td>
<td>Gas separation using a porous membrane on a metal support.
The model applies generalised Maxwell-Stefan equations to predict the fluxes and the selectivities.
The problem modelled is separation of CH4+C2H6 mixture on a zeolite (silicalite-1) membrane.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="tutorials-all.html#tutorial-che-9"><span class="std std-ref">Chem. Eng. Example 9</span></a></td>
<td>Industrial batch reactor example from Dow Chemical Company.</td>
</tr>
</tbody>
</table>
<div class="section" id="module-daetools.examples.tutorial_che_1">
<span id="chem-eng-example-1"></span><span id="tutorial-che-1"></span><h2>8.5.1. Chem. Eng. Example 1<a class="headerlink" href="#module-daetools.examples.tutorial_che_1" title="Permalink to this headline">¶</a></h2>
<p>Continuously Stirred Tank Reactor with energy balance and Van de Vusse reactions:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span> A -&gt; B -&gt; C
2A -&gt; D
</pre></div>
</div>
<p>Reference: G.A. Ridlehoover, R.C. Seagrave. Optimization of Van de Vusse Reaction Kinetics
Using Semibatch Reactor Operation, Ind. Eng. Chem. Fundamen. 1973;12(4):444-447.
<a class="reference external" href="https://doi.org/10.1021/i160048a700">doi:10.1021/i160048a700</a></p>
<p>The concentrations plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_1-results.png"><img alt="_images/tutorial_che_1-results.png" src="_images/tutorial_che_1-results.png" style="width: 500px;" /></a>
<p>The temperatures plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_1-results2.png"><img alt="_images/tutorial_che_1-results2.png" src="_images/tutorial_che_1-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_1.xml">tutorial_che_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_1-rt.xml">tutorial_che_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_1.html">tutorial_che_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_2">
<span id="chem-eng-example-2"></span><span id="tutorial-che-2"></span><h2>8.5.2. Chem. Eng. Example 2<a class="headerlink" href="#module-daetools.examples.tutorial_che_2" title="Permalink to this headline">¶</a></h2>
<p>Binary distillation column model.</p>
<p>Reference: J. Hahn, T.F. Edgar. An improved method for nonlinear model reduction using
balancing of empirical gramians. Computers and Chemical Engineering 2002; 26:1379-1397.
<a class="reference external" href="http://dx.doi.org/10.1016/S0098-1354(02)00120-5">doi:10.1016/S0098-1354(02)00120-5</a></p>
<p>The liquid fraction after 120 min (x(reboiler)=0.935420, x(condenser)=0.064581):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_2-results.png"><img alt="_images/tutorial_che_2-results.png" src="_images/tutorial_che_2-results.png" style="width: 500px;" /></a>
<p>The liquid fraction in the reboiler (tray 1) and in the condenser (tray 32):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_2-results2.png"><img alt="_images/tutorial_che_2-results2.png" src="_images/tutorial_che_2-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_2.xml">tutorial_che_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_2-rt.xml">tutorial_che_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_2.html">tutorial_che_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_3">
<span id="chem-eng-example-3"></span><span id="tutorial-che-3"></span><h2>8.5.3. Chem. Eng. Example 3<a class="headerlink" href="#module-daetools.examples.tutorial_che_3" title="Permalink to this headline">¶</a></h2>
<p>Batch reactor seeded crystallisation using the method of moments.</p>
<p>References (model equations and input parameters):</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. (2016) Application of the Lagrangian Meshfree Approach
to Modelling of Batch Crystallisation: Part I - Modelling of Stirred Tank Hydrodynamics.
Chemical Engineering Science 145:317-328.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ces.2015.08.052">doi:10.1016/j.ces.2015.08.052</a></li>
<li>Mitchell N.A., O&#8217;Ciardha C.T., Frawley P.J. (2011) Estimation of the growth kinetics
for the cooling crystallisation of paracetamol and ethanol solutions.
Journal of Crystal Growth 328:39-49.
<a class="reference external" href="http://dx.doi.org/10.1016/j.jcrysgro.2011.06.016">doi:10.1016/j.jcrysgro.2011.06.016</a></li>
</ul>
<p>The main assumptions:</p>
<ul class="simple">
<li>Seeded crystallisation</li>
<li>Ideal mixing</li>
<li>Fixed cooling rate</li>
<li>Size independent growth</li>
</ul>
<p>Solubility of Paracetamol in ethanol:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>---------------------------------------------------------
Temperature       Solubility          Solubility 
     C        kg Parac./kg EtOH   mol Parac./m3 EtOH
---------------------------------------------------------
      0           0.11362                593.0387
     10           0.14128                737.4215
     20           0.17568                916.9562
     30           0.21845                1140.2008
     40           0.27163                1417.7972
     50           0.33777                1762.9779
     60           0.42000                2192.1973
---------------------------------------------------------
</pre></div>
</div>
<p>The supersaturation plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results.png"><img alt="_images/tutorial_che_3-results.png" src="_images/tutorial_che_3-results.png" style="width: 500px;" /></a>
<p>The concentration plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results2.png"><img alt="_images/tutorial_che_3-results2.png" src="_images/tutorial_che_3-results2.png" style="width: 500px;" /></a>
<p>The recovery plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results3.png"><img alt="_images/tutorial_che_3-results3.png" src="_images/tutorial_che_3-results3.png" style="width: 500px;" /></a>
<p>The yield plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results4.png"><img alt="_images/tutorial_che_3-results4.png" src="_images/tutorial_che_3-results4.png" style="width: 500px;" /></a>
<p>The total number of crystals plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results5.png"><img alt="_images/tutorial_che_3-results5.png" src="_images/tutorial_che_3-results5.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_3.xml">tutorial_che_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_3-rt.xml">tutorial_che_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_3.html">tutorial_che_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_4">
<span id="chem-eng-example-4"></span><span id="tutorial-che-4"></span><h2>8.5.4. Chem. Eng. Example 4<a class="headerlink" href="#module-daetools.examples.tutorial_che_4" title="Permalink to this headline">¶</a></h2>
<p>This example shows a comparison between the analytical results and the discretised
population balance equations results solved using the cell centered finite volume method
employing the high resolution upwind scheme (Van Leer k-interpolation with k = 1/3) and
a range of flux limiters.</p>
<p>This tutorial can be run from the console only.</p>
<p>The problem is from the section 4.1.1 Size-independent growth I of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. Application of the Lagrangian Meshfree Approach to
Modelling of Batch Crystallisation: Part II – An Efficient Solution of Integrated CFD
and Population Balance Equations. Preprints 2016, 20161100128.
<a class="reference external" href="http://dx.doi.org/10.20944/preprints201611.0012.v1">doi:10.20944/preprints201611.0012.v1</a></li>
</ul>
<p>and also from the section 3.1 Size-independent growth of the following article:</p>
<ul class="simple">
<li>Qamar S., Elsner M.P., Angelov I.A., Warnecke G., Seidel-Morgenstern A. (2006)
A comparative study of high resolution schemes for solving population balances in crystallization.
Computers and Chemical Engineering 30(6-7):1119-1131.
<a class="reference external" href="http://dx.doi.org/10.1016/j.compchemeng.2006.02.012">doi:10.1016/j.compchemeng.2006.02.012</a></li>
</ul>
<p>The growth-only crystallisation process was considered with the constant growth rate
of 1μm/s and the following initial number density function:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>n(L,0): 1E10, if 10μm &lt; L &lt; 20μm
           0, otherwise
</pre></div>
</div>
<p>The crystal size in the range of [0, 100]μm was discretised into 100 elements.
The analytical solution in this case is equal to the initial profile translated right
in time by a distance Gt (the growth rate multiplied by the time elapsed in the process).</p>
<p>The flux limiters used in the model are:</p>
<ul class="simple">
<li>HCUS</li>
<li>HQUICK</li>
<li>Koren</li>
<li>monotinized_central</li>
<li>minmod</li>
<li>Osher</li>
<li>ospre</li>
<li>smart</li>
<li>superbee</li>
<li>Sweby</li>
<li>UMIST</li>
<li>vanAlbada1</li>
<li>vanAlbada2</li>
<li>vanLeer</li>
<li>vanLeer_minmod</li>
</ul>
<p>Comparison of L1- and L2-norms (ni_HR - ni_analytical):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>--------------------------------------
         Scheme  L1         L2
--------------------------------------
       superbee  1.786e+10  7.016e+09
          Sweby  2.817e+10  8.614e+09
          Koren  3.015e+10  9.293e+09
          smart  2.961e+10  9.326e+09
             MC  3.258e+10  9.807e+09
           HCUS  3.638e+10  1.001e+10
         HQUICK  3.622e+10  1.005e+10
  vanLeerMinmod  3.581e+10  1.011e+10
        vanLeer  3.874e+10  1.059e+10
          ospre  4.139e+10  1.094e+10
          UMIST  4.363e+10  1.136e+10
          Osher  4.579e+10  1.156e+10
     vanAlbada1  4.574e+10  1.157e+10
         minmod  5.653e+10  1.325e+10
     vanAlbada2  5.456e+10  1.331e+10
 -------------------------------------
</pre></div>
</div>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Superbee flux limiter at t=60s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-results.png"><img alt="_images/tutorial_che_4-results.png" src="_images/tutorial_che_4-results.png" style="width: 500px;" /></a>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Koren flux limiter at t=60s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-results2.png"><img alt="_images/tutorial_che_4-results2.png" src="_images/tutorial_che_4-results2.png" style="width: 500px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-animation.gif"><img alt="_images/tutorial_che_4-animation.gif" src="_images/tutorial_che_4-animation.gif" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_4.html">tutorial_che_4.py</a></td>
</tr>
<tr class="row-even"><td>Analytical solution</td>
<td><a class="reference external" href="examples/fl_analytical.html">fl_analytical.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_5">
<span id="chem-eng-example-5"></span><span id="tutorial-che-5"></span><h2>8.5.5. Chem. Eng. Example 5<a class="headerlink" href="#module-daetools.examples.tutorial_che_5" title="Permalink to this headline">¶</a></h2>
<p>Similar to the chem. eng. example 4, this example shows a comparison between the analytical
results and the discretised population balance equations results solved using the cell
centered finite volume method employing the high resolution upwind scheme (Van Leer
k-interpolation with k = 1/3) and a range of flux limiters.</p>
<p>This tutorial can be run from the console only.</p>
<p>The problem is from the section 4.1.2 Size-independent growth II of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. Application of the Lagrangian Meshfree Approach to
Modelling of Batch Crystallisation: Part II – An Efficient Solution of Integrated CFD
and Population Balance Equations. Preprints 2016, 20161100128.
<a class="reference external" href="http://dx.doi.org/10.20944/preprints201611.0012.v1">doi:10.20944/preprints201611.0012.v1</a></li>
</ul>
<p>and also from the section 3.2 Size-independent growth of the following article:</p>
<ul class="simple">
<li>Qamar S., Elsner M.P., Angelov I.A., Warnecke G., Seidel-Morgenstern A. (2006)
A comparative study of high resolution schemes for solving population balances in crystallization.
Computers and Chemical Engineering 30(6-7):1119-1131.
<a class="reference external" href="http://dx.doi.org/10.1016/j.compchemeng.2006.02.012">doi:10.1016/j.compchemeng.2006.02.012</a></li>
</ul>
<p>Again, the growth-only crystallisation process was considered with the constant growth rate
of 0.1μm/s and with the different initial number density function:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>n(L,0):                      0, if        L &lt;= 2.0μm
                          1E10, if  2μm &lt; L &lt;= 10μm (region I)
                             0, if 10μm &lt; L &lt;= 18μm
      1E10*cos^2(pi*(L-26)/64), if 18μm &lt; L &lt;= 34μm (region II)
                             0, if 34μm &lt; L &lt;= 42μm
      1E10*sqrt(1-(L-50)^2/64), if 42μm &lt; L &lt;= 58μm (region III)
                             0, if 58μm &lt; L &lt;= 66μm
1E10*exp(-(L-70)^2/(2sigma^2)), if 66μm &lt; L &lt;= 74μm (region IV)
                             0, if 74μm &lt; L
</pre></div>
</div>
<p>The crystal size in the range of [0, 100]μm was discretised into 200 elements.
The analytical solution in this case is equal to the initial profile translated right
in time by a distance Gt (the growth rate multiplied by the time elapsed in the process).</p>
<p>Comparison of L1- and L2-norms (ni_HR - ni_analytical):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>-------------------------------------
        Scheme  L1         L2
-------------------------------------
      superbee  4.464e+10  1.015e+10
         smart  4.727e+10  1.120e+10
         Koren  4.861e+10  1.141e+10
         Sweby  5.435e+10  1.142e+10
            MC  5.129e+10  1.162e+10
        HQUICK  5.531e+10  1.194e+10
          HCUS  5.528e+10  1.194e+10
 vanLeerMinmod  5.600e+10  1.202e+10
       vanLeer  5.814e+10  1.225e+10
         ospre  6.131e+10  1.252e+10
         UMIST  6.181e+10  1.259e+10
         Osher  6.690e+10  1.275e+10
    vanAlbada1  6.600e+10  1.281e+10
        minmod  7.751e+10  1.360e+10
    vanAlbada2  7.901e+10  1.413e+10
-------------------------------------
</pre></div>
</div>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Superbee flux limiter at t=100s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_5-results.png"><img alt="_images/tutorial_che_5-results.png" src="_images/tutorial_che_5-results.png" style="width: 500px;" /></a>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Koren flux limiter at t=100s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_5-results2.png"><img alt="_images/tutorial_che_5-results2.png" src="_images/tutorial_che_5-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_5.html">tutorial_che_5.py</a></td>
</tr>
<tr class="row-even"><td>Analytical solution</td>
<td><a class="reference external" href="examples/fl_analytical.html">fl_analytical.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_6">
<span id="chem-eng-example-6"></span><span id="tutorial-che-6"></span><h2>8.5.6. Chem. Eng. Example 6<a class="headerlink" href="#module-daetools.examples.tutorial_che_6" title="Permalink to this headline">¶</a></h2>
<p>Model of a lithium-ion battery based on porous electrode theory as developed
by John Newman and coworkers. In particular, the equations here are based on a summary
of the methodology by Karen E. Thomas, John Newman, and Robert M. Darling,</p>
<p>Thomas K., Newman J., Darling R. (2002). Mathematical Modeling of Lithium Batteries
in Advances in Lithium-ion Batteries. Springer US. 345-392.
<a class="reference external" href="http://dx.doi.org/10.1007/0-306-47508-1_13">doi:10.1007/0-306-47508-1_13</a></p>
<p>A few simplifications have been made rather than implementing the more complete model described there.
For example, the following assumptions have (currently) been made:</p>
<ul class="simple">
<li>two porous electrodes are used rather than providing the option for a &#8220;half cell&#8221; in which
one electrode is lithium foil.</li>
<li>conductivity in the electron-conducting phase is infinite</li>
<li>constant exchange current density in Butler-Volmer reaction expression</li>
<li>no electrolyte convection</li>
<li>constant and uniform solvent concentration (ions vary according to concentrated solution theory)</li>
<li>monodisperse particles in electrode</li>
<li>no volume occupied by binder, filler, etc. in the electrode</li>
</ul>
<p>The up to date version of the model is available at Raymond&#8217;s GitHub repository:
<a class="reference external" href="https://github.com/raybsmith/daetools-example-battery">https://github.com/raybsmith/daetools-example-battery</a>.</p>
<p>The voltage plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_6-results.png"><img alt="_images/tutorial_che_6-results.png" src="_images/tutorial_che_6-results.png" style="width: 500px;" /></a>
<p>The current plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_6-results2.png"><img alt="_images/tutorial_che_6-results2.png" src="_images/tutorial_che_6-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_6.xml">tutorial_che_6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_6-rt.xml">tutorial_che_6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_6.html">tutorial_che_6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_7">
<span id="chem-eng-example-7"></span><span id="tutorial-che-7"></span><h2>8.5.7. Chem. Eng. Example 7<a class="headerlink" href="#module-daetools.examples.tutorial_che_7" title="Permalink to this headline">¶</a></h2>
<p>Steady-state Plug Flow Reactor with energy balance and first order reaction:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>A -&gt; B
</pre></div>
</div>
<p>The problem is example 9.4.3 from the section 9.4 Nonisothermal Plug Flow Reactor
from the following book:</p>
<ul class="simple">
<li>Davis M.E., Davis R.J. (2003) Fundamentals of Chemical Reaction Engineering.
McGraw Hill, New York, US. ISBN 007245007X.</li>
</ul>
<p>The dimensionless concentration plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_7-results.png"><img alt="_images/tutorial_che_7-results.png" src="_images/tutorial_che_7-results.png" style="width: 500px;" /></a>
<p>The dimensionless temperature plot (adiabatic and nonisothermal cases):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_7-results2.png"><img alt="_images/tutorial_che_7-results2.png" src="_images/tutorial_che_7-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_7.xml">tutorial_che_7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_7-rt.xml">tutorial_che_7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_7.html">tutorial_che_7.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_8">
<span id="chem-eng-example-8"></span><span id="tutorial-che-8"></span><h2>8.5.8. Chem. Eng. Example 8<a class="headerlink" href="#module-daetools.examples.tutorial_che_8" title="Permalink to this headline">¶</a></h2>
<p>Model of a gas separation on a porous membrane with a metal support. The model employs
the Generalised Maxwell-Stefan (GMS) equations to predict fluxes and selectivities.
The membrane unit model represents a generic two-dimensonal model of a porous membrane
and consists of four models:</p>
<ul class="simple">
<li>Retentate compartment (isothermal axially dispersed plug flow)</li>
<li>Micro-porous membrane</li>
<li>Macro-porous support layer</li>
<li>Permeate compartment (the same transport phenomena as in the retentate compartment)</li>
</ul>
<p>The retentate compartment, the porous membrane, the support layer and the permeate
compartment are coupled via molar flux, temperature, pressure and gas composition at
the interfaces.
The model is described in the section 2.2 Membrane modelling of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Kikkinides E.S. (2015) Modelling and optimization of PSA/Membrane
separation processes. Adsorption 21(4):283-305.
<a class="reference external" href="http://doi.org/10.1007/s10450-015-9670-z">doi:10.1007/s10450-015-9670-z</a></li>
</ul>
<p>and in the original Krishna article:</p>
<ul class="simple">
<li>Krishna R. (1993) A unified approach to the modeling of intraparticle
diffusion in adsorption processes. Gas Sep. Purif. 7(2):91-104.
<a class="reference external" href="http://doi.org/10.1016/0950-4214(93)85006-H">doi:10.1016/0950-4214(93)85006-H</a></li>
</ul>
<p>This version is somewhat simplified for it only offers an extended Langmuir isotherm.
The Ideal Adsorption Solution theory (IAS) and the Real Adsorption Solution theory (RAS)
described in the articles are not implemented here.</p>
<p>The problem modelled is separation of hydrocarbons (CH4+C2H6) mixture on a zeolite
(silicalite-1) membrane with a metal support from the section &#8216;Binary mixture permeation&#8217;
of the following article:</p>
<ul class="simple">
<li>van de Graaf J.M., Kapteijn F., Moulijn J.A. (1999) Modeling Permeation of Binary
Mixtures Through Zeolite Membranes. AIChE J. 45:497–511.
<a class="reference external" href="http://doi.org/10.1002/aic.690450307">doi:10.1002/aic.690450307</a></li>
</ul>
<p>The CH4 and C2H6 fluxes, and CH4/C2H6 selectivity plots for two cases: GMS and GMS(Dij=∞),
1:1 mixture, and T = 303 K:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_8-results.png"><img alt="_images/tutorial_che_8-results.png" src="_images/tutorial_che_8-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_8.xml">tutorial_che_8.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_8-rt.xml">tutorial_che_8-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_8.html">tutorial_che_8.py</a></td>
</tr>
<tr class="row-even"><td>Membrane unit</td>
<td><a class="reference external" href="examples/membrane_unit.html">membrane_unit.py</a></td>
</tr>
<tr class="row-odd"><td>Variable types</td>
<td><a class="reference external" href="examples/membrane_variable_types.html">membrane_variable_types.py</a></td>
</tr>
<tr class="row-even"><td>Membrane model</td>
<td><a class="reference external" href="examples/membrane.html">membrane.py</a></td>
</tr>
<tr class="row-odd"><td>Support model</td>
<td><a class="reference external" href="examples/support.html">support.py</a></td>
</tr>
<tr class="row-even"><td>In/out compartment</td>
<td><a class="reference external" href="examples/compartment.html">compartment.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_9">
<span id="chem-eng-example-9"></span><span id="tutorial-che-9"></span><h2>8.5.9. Chem. Eng. Example 9<a class="headerlink" href="#module-daetools.examples.tutorial_che_9" title="Permalink to this headline">¶</a></h2>
<p>Chemical reaction network from the Dow Chemical Company described in the following article:</p>
<ul class="simple">
<li>Caracotsios M., Stewart W.E. (1985) Sensitivity analysis of initial value problems 
with mixed odes and algebraic equations. Computers &amp; Chemical Engineering 9(4):359-365.
<a class="reference external" href="https://doi.org/10.1016/0098-1354(85)85014-6">doi:10.1016/0098-1354(85)85014-6</a></li>
</ul>
<p>The sensitivity analysis is enabled and the sensitivity data can be obtained in two ways:</p>
<ul class="simple">
<li>Directly from the DAE solver in the user-defined Run function using the
DAESolver.SensitivityMatrix property.</li>
<li>From the data reporter as any ordinary variable.</li>
</ul>
<p>The concentrations plot (u1, u3, u4):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results1.png"><img alt="_images/tutorial_che_9-results1.png" src="_images/tutorial_che_9-results1.png" style="width: 500px;" /></a>
<p>The concentrations plot (u6, u8):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results2.png"><img alt="_images/tutorial_che_9-results2.png" src="_images/tutorial_che_9-results2.png" style="width: 500px;" /></a>
<p>The sensitivities plot (k2*du1/dk2, k2*du2/dk2, k2*du3/dk2, k2*du4/dk2, k2*du5/dk2):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results3.png"><img alt="_images/tutorial_che_9-results3.png" src="_images/tutorial_che_9-results3.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="examples/tutorial_che_9.xml">tutorial_che_9.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="examples/tutorial_che_9-rt.xml">tutorial_che_9-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="examples/tutorial_che_9.html">tutorial_che_9.py</a></td>
</tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/tutorials-chemeng.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2008-2019, Dragan Nikolic.<br/>
      Last updated on Mar 29, 2019.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52277546-1', 'daetools.com');
  ga('send', 'pageview');
</script>


  </body>
</html>