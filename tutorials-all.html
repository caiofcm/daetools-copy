<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>All Tutorials &#8212; DAE Tools 1.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/[d][a][e].ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/[d][a][e]_Tools_project.png"></span>
          DAE Tools</a>
        <span class="navbar-text navbar-version pull-left"><b>1.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="/">Home</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="paradigms.html">2. Programming Paradigms</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_daetools.html">4. Getting DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">5. Getting Started with DAE Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_user_guide.html">6. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyDAE_api_ref.html">7. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">All Tutorials</a><ul>
<li><a class="reference internal" href="#module-daetools.examples.whats_the_time">What&#8217;s the time? (AKA: Hello world!)</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial1">Tutorial 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial2">Tutorial 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial3">Tutorial 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial4">Tutorial 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial5">Tutorial 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial6">Tutorial 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial7">Tutorial 7</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial8">Tutorial 8</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial9">Tutorial 9</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial10">Tutorial 10</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial11">Tutorial 11</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial12">Tutorial 12</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial13">Tutorial 13</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial14">Tutorial 14</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial15">Tutorial 15</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial16">Tutorial 16</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial17">Tutorial 17</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial18">Tutorial 18</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial19">Tutorial 19</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial20">Tutorial 20</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial21">Tutorial 21</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_adv_1">Advanced Tutorial 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_adv_2">Advanced Tutorial 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_adv_3">Advanced Tutorial 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_adv_4">Advanced Tutorial 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_1">Code Verification Test 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_2">Code Verification Test 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_3">Code Verification Test 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_4">Code Verification Test 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_5">Code Verification Test 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_6">Code Verification Test 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_7">Code Verification Test 7</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_8">Code Verification Test 8</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_9">Code Verification Test 9</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_10">Code Verification Test 10</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_cv_11">Code Verification Test 11</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_1">Tutorial deal.II 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_2">Tutorial deal.II 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_3">Tutorial deal.II 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_4">Tutorial deal.II 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_5">Tutorial deal.II 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_6">Tutorial deal.II 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_7">Tutorial deal.II 7</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_dealii_8">Tutorial deal.II 8</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_1">Chem. Eng. Example 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_2">Chem. Eng. Example 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_3">Chem. Eng. Example 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_4">Chem. Eng. Example 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_5">Chem. Eng. Example 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_6">Chem. Eng. Example 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_7">Chem. Eng. Example 7</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_8">Chem. Eng. Example 8</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_9">Chem. Eng. Example 9</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_1">Sensitivity Analysis Example 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_2">Sensitivity Analysis Example 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_sa_3">Sensitivity Analysis Example 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_dae_1">OpenCS Example DAE 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_dae_2">OpenCS Example DAE 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_dae_3">OpenCS Example DAE 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_ode_1">OpenCS Example ODE 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_ode_2">OpenCS Example ODE 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_opencs_ode_3">OpenCS Example ODE 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_1">Chem. Eng. Optimisation Example 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_2">Chem. Eng. Optimisation Example 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_3">Chem. Eng. Optimisation Example 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_4">Chem. Eng. Optimisation Example 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_5">Chem. Eng. Optimisation Example 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.tutorial_che_opt_6">Chem. Eng. Optimisation Example 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial1">Optimisation tutorial 1</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial2">Optimisation tutorial 2</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial3">Optimisation tutorial 3</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial4">Optimisation tutorial 4</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial5">Optimisation tutorial 5</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial6">Optimisation tutorial 6</a></li>
<li><a class="reference internal" href="#module-daetools.examples.opt_tutorial7">Optimisation tutorial 7</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="all-tutorials">
<h1>All Tutorials<a class="headerlink" href="#all-tutorials" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-daetools.examples.whats_the_time">
<span id="what-s-the-time-aka-hello-world"></span><span id="whats-the-time"></span><h2>What&#8217;s the time? (AKA: Hello world!)<a class="headerlink" href="#module-daetools.examples.whats_the_time" title="Permalink to this headline">¶</a></h2>
<p>What is the time? (AKA Hello world!) is a very simple model. The model consists of
a single variable (called &#8216;time&#8217;) and a single differential equation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This way, the value of the variable &#8216;time&#8217; is equal to the elapsed time in the
simulation at any moment.</p>
<p>This tutorial presents the basic structure of daeModel and daeSimulation classes.
A typical DAETools simulation requires the following 8 tasks:</p>
<ol class="arabic simple">
<li>Importing DAE Tools pyDAE module(s)</li>
<li>Importing or declaration of units and variable types
(unit and daeVariableType classes)</li>
<li>Developing a model by deriving a class from the base daeModel class and:<ul>
<li>Declaring domains, parameters and variables in the daeModel.__init__ function</li>
<li>Declaring equations and their residual expressions in the
daeModel.DeclareEquations function</li>
</ul>
</li>
<li>Setting up a simulation by deriving a class from the base daeSimulation class and:<ul>
<li>Specifying a model to be used in the simulation in the daeSimulation.__init__ function</li>
<li>Setting the values of parameters in the daeSimulation.SetUpParametersAndDomains function</li>
<li>Setting initial conditions in the daeSimulation.SetUpVariables function</li>
</ul>
</li>
<li>Declaring auxiliary objects required for the simulation<ul>
<li>DAE solver object</li>
<li>Data reporter object</li>
<li>Log object</li>
</ul>
</li>
<li>Setting the run-time options for the simulation:<ul>
<li>ReportingInterval</li>
<li>TimeHorizon</li>
</ul>
</li>
<li>Connecting a data reporter</li>
<li>Initializing, running and finalizing the simulation</li>
</ol>
<p>The &#8216;time&#8217; variable plot:</p>
<a class="reference internal image-reference" href="_images/whats_the_time-results.png"><img alt="_images/whats_the_time-results.png" src="_images/whats_the_time-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/whats_the_time.xml">whats_the_time.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/whats_the_time-rt.xml">whats_the_time-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/whats_the_time.html">whats_the_time.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial1">
<span id="tutorial-1"></span><span id="tutorial1"></span><h2>Tutorial 1<a class="headerlink" href="#module-daetools.examples.tutorial1" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces several new concepts:</p>
<ul class="simple">
<li>Distribution domains</li>
<li>Distributed parameters, variables and equations</li>
<li>Setting boundary conditions (Neumann and Dirichlet type)</li>
<li>Setting initial conditions</li>
</ul>
<p>In this example we model a simple heat conduction problem: a conduction through
a very thin, rectangular copper plate.</p>
<p>For this problem, we need a two-dimensional Cartesian grid (x,y)
(here, for simplicity, divided into 10 x 10 segments):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span> y axis
    ^
    |
Ly -| L T T T T T T T T T R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
    | L + + + + + + + + + R
 0 -| L B B B B B B B B B R
    --|-------------------|-------&gt; x axis
      0                   Lx
</pre></div>
</div>
<p>Points &#8216;B&#8217; at the bottom edge of the plate (for y = 0), and the points &#8216;T&#8217; at the
top edge of the plate (for y = Ly) represent the points where the heat is applied.</p>
<p>The plate is considered insulated at the left (x = 0) and the right edges (x = Lx)
of the plate (points &#8216;L&#8217; and &#8216;R&#8217;). To model this type of problem, we have to write
a heat balance equation for all interior points except the left, right, top and
bottom edges, where we need to specify boundary conditions.</p>
<p>In this problem we have to define two distribution domains:</p>
<ul class="simple">
<li>x (x axis, length Lx = 0.1 m)</li>
<li>y (y axis, length Ly = 0.1 m)</li>
</ul>
<p>the following parameters:</p>
<ul class="simple">
<li>rho: copper density, 8960 kg/m3</li>
<li>cp:  copper specific heat capacity, 385 J/(kgK)</li>
<li>k:   copper heat conductivity, 401 W/(mK)</li>
<li>Qb:  heat flux at the bottom edge, 1E6 W/m2 (or 100 W/cm2)</li>
<li>Tt:  temperature at the top edge, 300 K</li>
</ul>
<p>and a single variable:</p>
<ul class="simple">
<li>T: the temperature of the plate (distributed on x and y domains)</li>
</ul>
<p>The model consists of 5 equations (1 distributed equation + 4 boundary conditions):</p>
<ol class="arabic">
<li><p class="first">Heat balance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">*</span> <span class="n">cp</span> <span class="o">*</span> <span class="n">dT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">[</span><span class="n">d2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dx2</span> <span class="o">+</span> <span class="n">d2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dy2</span><span class="p">];</span>  <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">),</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Neumann boundary conditions at the bottom edge:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">dT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dy</span> <span class="o">=</span> <span class="n">Qb</span><span class="p">;</span>  <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p class="first">Dirichlet boundary conditions at the top edge:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tt</span><span class="p">;</span>  <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ly</span>
</pre></div>
</div>
</li>
<li><p class="first">Neumann boundary conditions at the left edge (insulated):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p class="first">Neumann boundary conditions at the right edge (insulated):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Lx</span>
</pre></div>
</div>
</li>
</ol>
<p>The temperature plot (at t=100s, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial1-results.png"><img alt="_images/tutorial1-results.png" src="_images/tutorial1-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial1.xml">tutorial1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial1-rt.xml">tutorial1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial1.html">tutorial1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial2">
<span id="tutorial-2"></span><span id="tutorial2"></span><h2>Tutorial 2<a class="headerlink" href="#module-daetools.examples.tutorial2" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Arrays (discrete distribution domains)</li>
<li>Distributed parameters</li>
<li>Making equations more readable</li>
<li>Degrees of freedom</li>
<li>Setting an initial guess for variables (used by a DAE solver during an initial phase)</li>
<li>Print DAE solver statistics</li>
</ul>
<p>The model in this example is very similar to the model used in the tutorial 1.
The differences are:</p>
<ul class="simple">
<li>The heat capacity is temperature dependent</li>
<li>Different boundary conditions are applied</li>
</ul>
<p>The temperature plot (at t=100s, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial2-results.png"><img alt="_images/tutorial2-results.png" src="_images/tutorial2-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial2.xml">tutorial2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial2-rt.xml">tutorial2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial2.html">tutorial2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial3">
<span id="tutorial-3"></span><span id="tutorial3"></span><h2>Tutorial 3<a class="headerlink" href="#module-daetools.examples.tutorial3" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Arrays of variable values</li>
<li>Functions that operate on arrays of values</li>
<li>Functions that create constants and arrays of constant values (Constant and Array)</li>
<li>Non-uniform domain grids</li>
</ul>
<p>The model in this example is identical to the model used in the tutorial 1.
Some additional equations that calculate the total flux at the bottom edge are added
to illustrate the array functions.</p>
<p>The temperature plot (at t=100, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial3-results.png"><img alt="_images/tutorial3-results.png" src="_images/tutorial3-results.png" style="width: 500px;" /></a>
<p>The average temperature plot (considering the whole x-y domain):</p>
<a class="reference internal image-reference" href="_images/tutorial3-results2.png"><img alt="_images/tutorial3-results2.png" src="_images/tutorial3-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial3.xml">tutorial3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial3-rt.xml">tutorial3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial3.html">tutorial3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial4">
<span id="tutorial-4"></span><span id="tutorial4"></span><h2>Tutorial 4<a class="headerlink" href="#module-daetools.examples.tutorial4" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Discontinuous equations (symmetrical state transition networks: daeIF statements)</li>
<li>Building of Jacobian expressions</li>
</ul>
<p>In this example we model a very simple heat transfer problem where a small piece of copper
is at one side exposed to the source of heat and at the other to the surroundings.</p>
<p>The lumped heat balance is given by the following equation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">*</span> <span class="n">cp</span> <span class="o">*</span> <span class="n">dT</span><span class="o">/</span><span class="n">dt</span> <span class="o">-</span> <span class="n">Qin</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">Tsurr</span><span class="p">)</span>
</pre></div>
</div>
<p>where Qin is the power of the heater, h is the heat transfer coefficient,
A is the surface area and Tsurr is the temperature of the surrounding air.</p>
<p>The process starts at the temperature of the metal of 283K.
The metal is allowed to warm up for 200 seconds, when the heat source is
removed and the metal cools down slowly to the ambient temperature.</p>
<p>This can be modelled using the following symmetrical state transition network:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>IF t &lt; 200
  Qin = 1500 W
ELSE
  Qin = 0 W
</pre></div>
</div>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial4-results.png"><img alt="_images/tutorial4-results.png" src="_images/tutorial4-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial4.xml">tutorial4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial4-rt.xml">tutorial4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial4.html">tutorial4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial5">
<span id="tutorial-5"></span><span id="tutorial5"></span><h2>Tutorial 5<a class="headerlink" href="#module-daetools.examples.tutorial5" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Discontinuous equations (non-symmetrical state transition networks: daeSTN statements)</li>
</ul>
<p>In this example we use the same heat transfer problem as in the tutorial 4.
Again we have a piece of copper which is at one side exposed to the source of heat
and at the other to the surroundings.</p>
<p>The process starts at the temperature of 283K. The metal is allowed to warm up, and then
its temperature is kept in the interval (320K - 340K) for 350 seconds. This is performed
by switching the heater on when the temperature drops to 320K and by switching the heater
off when the temperature reaches 340K.
After 350s the heat source is permanently switched off and the metal is allowed to
slowly cool down to the ambient temperature.</p>
<p>This can be modelled using the following non-symmetrical state transition network:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>STN Regulator
  case Heating:
    Qin = 1500 W
    on condition T &gt; 340K switch to Regulator.Cooling
    on condition t &gt; 350s switch to Regulator.HeaterOff

  case Cooling:
    Qin = 0 W
    on condition T &lt; 320K switch to Regulator.Heating
    on condition t &gt; 350s switch to Regulator.HeaterOff

  case HeaterOff:
    Qin = 0 W
</pre></div>
</div>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial5-results.png"><img alt="_images/tutorial5-results.png" src="_images/tutorial5-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial5.xml">tutorial5.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial5-rt.xml">tutorial5-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial5.html">tutorial5.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial6">
<span id="tutorial-6"></span><span id="tutorial6"></span><h2>Tutorial 6<a class="headerlink" href="#module-daetools.examples.tutorial6" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Ports</li>
<li>Port connections</li>
<li>Units (instances of other models)</li>
</ul>
<p>A simple port type &#8216;portSimple&#8217; is defined which contains only one variable &#8216;t&#8217;.
Two models &#8216;modPortIn&#8217; and &#8216;modPortOut&#8217; are defined, each having one port of type &#8216;portSimple&#8217;.
The wrapper model &#8216;modTutorial&#8217; instantiate these two models as its units and connects them
by connecting their ports.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial6.xml">tutorial6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial6-rt.xml">tutorial6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial6.html">tutorial6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial7">
<span id="tutorial-7"></span><span id="tutorial7"></span><h2>Tutorial 7<a class="headerlink" href="#module-daetools.examples.tutorial7" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Quasi steady state initial condition mode (eQuasiSteadyState flag)</li>
<li>User-defined schedules (operating procedures)</li>
<li>Resetting of degrees of freedom</li>
<li>Resetting of initial conditions</li>
</ul>
<p>In this example we use the same heat transfer problem as in the tutorial 4.
The input power of the heater is defined as a variable. Since there is
no equation defined to calculate the value of the input power, the system
contains N variables but only N-1 equations. To create a well-posed DAE system
one of the variable needs to be &#8220;fixed&#8221;. However the choice of variables is not
arbitrary and in this example the only variable that can be fixed is Qin. Thus,
the Qin variable represents a degree of freedom (DOF). Its value will be fixed
at the beginning of the simulation and later manipulated in the user-defined
schedule in the overloaded function daeSimulation.Run().</p>
<p>The default daeSimulation.Run() function (re-implemented in Python) is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Python implementation of daeSimulation::Run() C++ function.</span>
    
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">CurrentTime</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimeHorizon</span><span class="p">:</span>
        <span class="c1"># Get the time step (based on the TimeHorizon and the ReportingInterval).</span>
        <span class="c1"># Do not allow to get past the TimeHorizon.</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NextReportingTime</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimeHorizon</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimeHorizon</span>

        <span class="c1"># If the flag is set - a user tries to pause the simulation, therefore return.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ActivityAction</span> <span class="o">==</span> <span class="n">ePauseActivity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span><span class="s2">&quot;Activity paused by the user&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># If a discontinuity is found, loop until the end of the integration period.</span>
        <span class="c1"># The data will be reported around discontinuities!</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">CurrentTime</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span><span class="s2">&quot;Integrating from [</span><span class="si">%f</span><span class="s2">] to [</span><span class="si">%f</span><span class="s2">] ...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CurrentTime</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IntegrateUntilTime</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">eStopAtModelDiscontinuity</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># After the integration period, report the data. </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReportData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CurrentTime</span><span class="p">)</span>
        
        <span class="c1"># Set the simulation progress.</span>
        <span class="n">newProgress</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CurrentTime</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimeHorizon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">newProgress</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Progress</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Progress</span> <span class="o">=</span> <span class="n">newProgress</span>
</pre></div>
</div>
<p>In this example the following schedule is specified:</p>
<ol class="arabic simple">
<li>Re-assign the value of Qin to 500W, run the simulation for 100s 
using the IntegrateForTimeInterval function and report the data using the 
ReportData() function.</li>
<li>Re-assign the value of Qin to 7500W, run the simulation the time reaches 200s
using the IntegrateUntilTime function and report the data.</li>
<li>Re-assign the variable Qin to 1000W, run the simulation for 100s in OneStep mode
using the IntegrateForOneStep() function and report the data at every time step.</li>
<li>Re-assign the variable Qin to 1500W, re-initialise the temperature again to 300K,
run the simulation until the TimeHorizon is reached using the function Integrate() 
and report the data.</li>
</ol>
<p>The plot of the inlet power:</p>
<a class="reference internal image-reference" href="_images/tutorial7-results.png"><img alt="_images/tutorial7-results.png" src="_images/tutorial7-results.png" style="width: 500px;" /></a>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial7-results2.png"><img alt="_images/tutorial7-results2.png" src="_images/tutorial7-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial7.xml">tutorial7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial7-rt.xml">tutorial7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial7.html">tutorial7.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial8">
<span id="tutorial-8"></span><span id="tutorial8"></span><h2>Tutorial 8<a class="headerlink" href="#module-daetools.examples.tutorial8" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Data reporters and exporting results into the following file formats:<ul>
<li>Matlab MAT file (requires python-scipy package)</li>
<li>MS Excel .xls file (requires python-xlwt package)</li>
<li>JSON file (no third party dependencies)</li>
<li>VTK file (requires pyevtk and vtk packages)</li>
<li>XML file (requires python-lxml package)</li>
<li>HDF5 file (requires python-h5py package)</li>
<li>Pandas dataset (requires python-pandas package)</li>
</ul>
</li>
<li>Implementation of user-defined data reporters</li>
<li>daeDelegateDataReporter</li>
</ul>
<p>Some time it is not enough to send the results to the DAE Plotter but it is desirable to
export them into a specified file format (i.e. for use in other programs). For that purpose,
daetools provide a range of data reporters that save the simulation results in various formats.
In adddition, daetools allow implementation of custom, user-defined data reporters.
As an example, a user-defined data reporter is developed to save the results
into a plain text file (after the simulation is finished). Obviously, the data can be
processed in any other fashion.
Moreover, in certain situation it is required to process the results in more than one way.
The daeDelegateDataReporter can be used in those cases. It has the same interface and the
functionality like all data reporters. However, it does not do any data processing itself
but calls the corresponding functions of data reporters which are added to it using the
function AddDataReporter. This way it is possible, at the same time, to send the results
to the DAE Plotter and save them into a file (or process the data in some other ways).
In this example the results are processed in 10 different ways at the same time.</p>
<p>The model used in this example is very similar to the model in the tutorials 4 and 5.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial8.xml">tutorial8.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial8-rt.xml">tutorial8-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial8.html">tutorial8.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial9">
<span id="tutorial-9"></span><span id="tutorial9"></span><h2>Tutorial 9<a class="headerlink" href="#module-daetools.examples.tutorial9" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Third party <strong>direct</strong> linear equations solvers</li>
</ul>
<p>Currently there are the following linear equations solvers available:</p>
<ul class="simple">
<li>SuperLU: sequential sparse direct solver defined in pySuperLU module (BSD licence)</li>
<li>SuperLU_MT: multi-threaded sparse direct solver defined in pySuperLU_MT module (BSD licence)</li>
<li>Trilinos Amesos: sequential sparse direct solver defined in pyTrilinos module (GNU Lesser GPL)</li>
<li>IntelPardiso: multi-threaded sparse direct solver defined in pyIntelPardiso module (proprietary)</li>
<li>Pardiso: multi-threaded sparse direct solver defined in pyPardiso module (proprietary)</li>
</ul>
<p>In this example we use the same conduction problem as in the tutorial 1.</p>
<p>The temperature plot (at t=100s, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial9-results.png"><img alt="_images/tutorial9-results.png" src="_images/tutorial9-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial9.xml">tutorial9.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial9-rt.xml">tutorial9-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial9.html">tutorial9.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial10">
<span id="tutorial-10"></span><span id="tutorial10"></span><h2>Tutorial 10<a class="headerlink" href="#module-daetools.examples.tutorial10" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Initialization files</li>
<li>Domains which bounds depend on parameter values</li>
<li>Evaluation of integrals</li>
</ul>
<p>In this example we use the same conduction problem as in the tutorial 1.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial10.xml">tutorial10.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial10-rt.xml">tutorial10-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial10.html">tutorial10.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial11">
<span id="tutorial-11"></span><span id="tutorial11"></span><h2>Tutorial 11<a class="headerlink" href="#module-daetools.examples.tutorial11" title="Permalink to this headline">¶</a></h2>
<p>This tutorial describes the use of iterative linear solvers (AztecOO from the Trilinos project)
with different preconditioners (built-in AztecOO, Ifpack or ML) and corresponding solver options.
Also, the range of Trilins Amesos solver options are shown.</p>
<p>The model is very similar to the model in tutorial 1, except for the different boundary conditions
and that the equations are written in a different way to maximise the number of items around the
diagonal (creating the problem with the diagonally dominant matrix).
These type of systems can be solved using very simple preconditioners such as Jacobi. To do so,
the interoperability with the NumPy package has been exploited and the package itertools used to
iterate through the distribution domains in x and y directions.</p>
<p>The equations are distributed in such a way that the following incidence matrix is obtained:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>|XXX                                 |
| X     X     X                      |
|  X     X     X                     |
|   X     X     X                    |
|    X     X     X                   |
|   XXX                              |
|      XXX                           |
| X    XXX    X                      |
|  X    XXX    X                     |
|   X    XXX    X                    |
|    X    XXX    X                   |
|         XXX                        |
|            XXX                     |
|       X    XXX    X                |
|        X    XXX    X               |
|         X    XXX    X              |
|          X    XXX    X             |
|               XXX                  |
|                  XXX               |
|             X    XXX    X          |
|              X    XXX    X         |
|               X    XXX    X        |
|                X    XXX    X       |
|                     XXX            |
|                        XXX         |
|                   X    XXX    X    |
|                    X    XXX    X   |
|                     X    XXX    X  |
|                      X    XXX    X |
|                           XXX      |
|                              XXX   |
|                   X     X     X    |
|                    X     X     X   |
|                     X     X     X  |
|                      X     X     X |
|                                 XXX|
</pre></div>
</div>
<p>The temperature plot (at t=100s, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial11-results.png"><img alt="_images/tutorial11-results.png" src="_images/tutorial11-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial11.xml">tutorial11.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial11-rt.xml">tutorial11-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial11.html">tutorial11.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial12">
<span id="tutorial-12"></span><span id="tutorial12"></span><h2>Tutorial 12<a class="headerlink" href="#module-daetools.examples.tutorial12" title="Permalink to this headline">¶</a></h2>
<p>This tutorial describes the use and available options for superLU direct linear solvers:</p>
<ul class="simple">
<li>Sequential: superLU</li>
<li>Multithreaded (OpenMP/posix threads): superLU_MT</li>
</ul>
<p>The model is the same as the model in tutorial 1, except for the different boundary conditions.</p>
<p>The temperature plot (at t=100s, x=0.5, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial12-results.png"><img alt="_images/tutorial12-results.png" src="_images/tutorial12-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial12.xml">tutorial12.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial12-rt.xml">tutorial12-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial12.html">tutorial12.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial13">
<span id="tutorial-13"></span><span id="tutorial13"></span><h2>Tutorial 13<a class="headerlink" href="#module-daetools.examples.tutorial13" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>The event ports</li>
<li>ON_CONDITION() function illustrating the types of actions that can be executed
during state transitions</li>
<li>ON_EVENT() function illustrating the types of actions that can be executed
when an event is triggered</li>
<li>User defined actions</li>
</ul>
<p>In this example we use the very similar model as in the tutorial 5.</p>
<p>The simulation output should show the following messages at t=100s and t=350s:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>...
********************************************************
simpleUserAction2 message:
This message should be fired when the time is 100s.
********************************************************
...
********************************************************
simpleUserAction executed; input data = 427.464093129832
********************************************************
...
</pre></div>
</div>
<p>The plot of the &#8216;event&#8217; variable:</p>
<a class="reference internal image-reference" href="_images/tutorial13-results.png"><img alt="_images/tutorial13-results.png" src="_images/tutorial13-results.png" style="width: 500px;" /></a>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial13-results2.png"><img alt="_images/tutorial13-results2.png" src="_images/tutorial13-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial13.xml">tutorial13.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial13-rt.xml">tutorial13-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial13.html">tutorial13.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial14">
<span id="tutorial-14"></span><span id="tutorial14"></span><h2>Tutorial 14<a class="headerlink" href="#module-daetools.examples.tutorial14" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial we introduce the external functions concept that can handle and execute
functions in external libraries. The daeScalarExternalFunction-derived external function
object is used to calculate the heat transferred and to interpolate a set of values
using the scipy.interpolate.interp1d object. In addition, functions defined in shared 
libraries (.so in GNU/Linux, .dll in Windows and .dylib in macOS) can be used via
ctypes Python library and daeCTypesExternalFunction class.</p>
<p>In this example we use the same model as in the tutorial 5 with few additional equations.</p>
<p>The simulation output should show the following messages at the end of simulation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>...
scipy.interp1d statistics:
  interp1d called 1703 times (cache value used 770 times)
</pre></div>
</div>
<p>The plot of the &#8216;Heat_ext1&#8217; variable:</p>
<a class="reference internal image-reference" href="_images/tutorial14-results.png"><img alt="_images/tutorial14-results.png" src="_images/tutorial14-results.png" style="width: 500px;" /></a>
<p>The plot of the &#8216;Heat_ext2&#8217; variable:</p>
<a class="reference internal image-reference" href="_images/tutorial14-results1.png"><img alt="_images/tutorial14-results1.png" src="_images/tutorial14-results1.png" style="width: 500px;" /></a>
<p>The plot of the &#8216;Value_interp&#8217; variable:</p>
<a class="reference internal image-reference" href="_images/tutorial14-results2.png"><img alt="_images/tutorial14-results2.png" src="_images/tutorial14-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial14.xml">tutorial14.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial14-rt.xml">tutorial14-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial14.html">tutorial14.py</a></td>
</tr>
<tr class="row-even"><td>External function source code</td>
<td><a class="reference external" href="./examples/tutorial14_heat_function.html">tutorial14_heat_function.c</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial15">
<span id="tutorial-15"></span><span id="tutorial15"></span><h2>Tutorial 15<a class="headerlink" href="#module-daetools.examples.tutorial15" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>Nested state transitions</li>
</ul>
<p>In this example we use the same model as in the tutorial 4 with the more complex STN:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>IF t &lt; 200
  IF 0 &lt;= t &lt; 100
     IF 0 &lt;= t &lt; 50
       Qin = 1600 W
     ELSE
       Qin = 1500 W
  ELSE
    Qin = 1400 W

ELSE IF 200 &lt;= t &lt; 300
  Qin = 1300 W

ELSE
  Qin = 0 W
</pre></div>
</div>
<p>The plot of the &#8216;Qin&#8217; variable:</p>
<a class="reference internal image-reference" href="_images/tutorial15-results.png"><img alt="_images/tutorial15-results.png" src="_images/tutorial15-results.png" style="width: 500px;" /></a>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial15-results2.png"><img alt="_images/tutorial15-results2.png" src="_images/tutorial15-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial15.xml">tutorial15.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial15-rt.xml">tutorial15-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial15.html">tutorial15.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial16">
<span id="tutorial-16"></span><span id="tutorial16"></span><h2>Tutorial 16<a class="headerlink" href="#module-daetools.examples.tutorial16" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows how to use DAE Tools objects with NumPy arrays to solve a simple
stationary heat conduction in one dimension using the Finite Elements method
with linear elements and two ways of manually assembling a stiffness matrix/load vector:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>d2T(x)/dx2 = F(x);  x in (0, Lx)
</pre></div>
</div>
<p>Linear finite elements discretisation and simple FE matrix assembly:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>                  phi                 phi
                     (k-1)               (k)
                     
                    *                   *             
                  * | *               * | *            
                *   |   *           *   |   *          
              *     |     *       *     |     *        
            *       |       *   *       |       *      
          *         |         *         |         *        
        *           |       *   *       |           *      
      *             |     *       *     |             *    
    *               |   *           *   |               *  
  *                 | *  element (k)  * |                 *
*-------------------*+++++++++++++++++++*-------------------*-
                    x                   x
                     (k-i                (k)
                   
                    \_________ _________/
                              |
                              dx
</pre></div>
</div>
<p>The comparison of the analytical solution and two ways of assembling the system is given
in the following plot:</p>
<a class="reference internal image-reference" href="_images/tutorial16-results.png"><img alt="_images/tutorial16-results.png" src="_images/tutorial16-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial16.xml">tutorial16.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial16-rt.xml">tutorial16-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial16.html">tutorial16.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial17">
<span id="tutorial-17"></span><span id="tutorial17"></span><h2>Tutorial 17<a class="headerlink" href="#module-daetools.examples.tutorial17" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>TCPIP Log and TCPIPLogServer</li>
</ul>
<p>In this example we use the same heat transfer problem as in the tutorial 7.</p>
<p>The screenshot of the TCP/IP log server:</p>
<a class="reference internal image-reference" href="_images/tutorial17-screenshot.png"><img alt="_images/tutorial17-screenshot.png" src="_images/tutorial17-screenshot.png" style="width: 500px;" /></a>
<p>The temperature plot:</p>
<a class="reference internal image-reference" href="_images/tutorial17-results.png"><img alt="_images/tutorial17-results.png" src="_images/tutorial17-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial17.xml">tutorial17.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial17-rt.xml">tutorial17-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial17.html">tutorial17.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial18">
<span id="tutorial-18"></span><span id="tutorial18"></span><h2>Tutorial 18<a class="headerlink" href="#module-daetools.examples.tutorial18" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows one more problem solved using the NumPy arrays that operate on
DAE Tools variables. The model is taken from the Sundials ARKODE (ark_analytic_sys.cpp).
The ODE system is defined by the following system of equations:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dy/dt = A*y
</pre></div>
</div>
<p>where:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>A = V * D * Vi
V = [1 -1 1; -1 2 1; 0 -1 2];
Vi = 0.25 * [5 1 -3; 2 2 -2; 1 1 1];
D = [-0.5 0 0; 0 -0.1 0; 0 0 lam];
</pre></div>
</div>
<p>lam is a large negative number.</p>
<p>The analytical solution to this problem is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Y(t) = V*exp(D*t)*Vi*Y0
</pre></div>
</div>
<p>for t in the interval [0.0, 0.05], with initial condition y(0) = [1,1,1]&#8217;.</p>
<p>The stiffness of the problem is directly proportional to the value of &#8220;lamda&#8221;.
The value of lamda should be negative to result in a well-posed ODE;
for values with magnitude larger than 100 the problem becomes quite stiff.</p>
<p>In this example, we choose lamda = -100.</p>
<p>The solution:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>lamda = -100
reltol = 1e-06
abstol = 1e-10

--------------------------------------
   t        y0        y1        y2
--------------------------------------
 0.0050   0.70327   0.70627   0.41004
 0.0100   0.52267   0.52865   0.05231
 0.0150   0.41249   0.42145  -0.16456
 0.0200   0.34504   0.35696  -0.29600
 0.0250   0.30349   0.31838  -0.37563
 0.0300   0.27767   0.29551  -0.42383
 0.0350   0.26138   0.28216  -0.45296
 0.0400   0.25088   0.27459  -0.47053
 0.0450   0.24389   0.27053  -0.48109
 0.0500   0.23903   0.26858  -0.48740
--------------------------------------
</pre></div>
</div>
<p>The plot of the &#8216;y0&#8217;, &#8216;y1&#8217;, &#8216;y2&#8217; variables:</p>
<a class="reference internal image-reference" href="_images/tutorial18-results.png"><img alt="_images/tutorial18-results.png" src="_images/tutorial18-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial18.xml">tutorial18.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial18-rt.xml">tutorial18-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial18.html">tutorial18.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial19">
<span id="tutorial-19"></span><span id="tutorial19"></span><h2>Tutorial 19<a class="headerlink" href="#module-daetools.examples.tutorial19" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the thermo physical property packages.</p>
<p>Since there are many thermo packages with a very different API the CapeOpen
standard has been adopted in daetools. This way, all thermo packages implementing
the CapeOpen thermo interfaces are automatically vailable to daetools. Those which
do not are wrapped by the class with the CapeOpen conforming API.
At the moment, two types of thermophysical property packages are implemented:</p>
<ul class="simple">
<li>Any CapeOpen v1.1 thermo package (available only in Windows)</li>
<li>CoolProp thermo package (available for all platforms) wrapped in
the class with the CapeOpen interface.</li>
</ul>
<p>The central point is the daeThermoPhysicalPropertyPackage class. It can load any
COM component that implements CapeOpen 1.1 ICapeThermoPropertyPackageManager interface
or the CoolProp thermo package.</p>
<p>The framework provides low-level functions (specified in the CapeOpen standard) in the
daeThermoPhysicalPropertyPackage class and the higher-level functions in the auxiliary
daeThermoPackage class defined in the daetools/pyDAE/thermo_packages.py file.
The low-level functions are defined in the ICapeThermoCoumpounds and ICapeThermoPropertyRoutine
CapeOpen interfaces. These functions come in two flavours:</p>
<ol class="loweralpha simple">
<li>The ordinary functions return adouble/adouble_array objects and can only be used to specify equations:<ul>
<li>GetCompoundConstant (from ICapeThermoCoumpounds interface)</li>
<li>GetTDependentProperty (from ICapeThermoCoumpounds interface)</li>
<li>GetPDependentProperty (from ICapeThermoCoumpounds interface)</li>
<li>CalcSinglePhaseScalarProperty (from ICapeThermoPropertyRoutine interface: scalar version)</li>
<li>CalcSinglePhaseVectorProperty (from ICapeThermoPropertyRoutine interface: vector version)</li>
<li>CalcTwoPhaseScalarProperty (from ICapeThermoPropertyRoutine interface: scalar version)</li>
<li>CalcTwoPhaseVectorProperty (from ICapeThermoPropertyRoutine interface: vector version)</li>
</ul>
</li>
<li>The functions starting with the underscores can be used for calculations (they use and return float values):<ul>
<li>_GetCompoundConstant</li>
<li>_GetTDependentProperty</li>
<li>_GetPDependentProperty</li>
<li>_CalcSinglePhaseScalarProperty</li>
<li>_CalcSinglePhaseVectorProperty</li>
<li>_CalcTwoPhaseScalarProperty</li>
<li>_CalcTwoPhaseVectorProperty</li>
</ul>
</li>
</ol>
<p>The daeThermoPackage auxiliary class offers functions to calculate specified properties, for instance:</p>
<ul class="simple">
<li>Transport properties:<ul>
<li>cp, kappa, mu, Dab (heat capacity, thermal conductivity, dynamic viscosity, diffusion coefficient)</li>
</ul>
</li>
<li>Thermodynamic properties:<ul>
<li>rho</li>
<li>h, s, G, H, I (enthalpy, entropy, gibbs/helmholtz/internal energy)</li>
<li>h_E, s_E, G_E, H_E, I_E, V_E (excess enthalpy, entropy, gibbs/helmholtz/internal energy, volume)</li>
<li>f and phi (fugacity and coefficient of fugacity)</li>
<li>a and gamma (activity and the coefficient of activity)</li>
<li>z (compressibility factor)</li>
<li>K, surfaceTension (ratio of fugacity coefficients and the surface tension)</li>
</ul>
</li>
</ul>
<dl class="docutils">
<dt>Nota bene:</dt>
<dd>Some of the above functions return scalars while the others return arrays of values.
Check the thermo_packages.py file for details.</dd>
</dl>
<p>All functions return properties in the SI units (as specified in the CapeOpen 1.1 standard).</p>
<p>Known issues:</p>
<ul class="simple">
<li>Many properties from the CapeOpen standard are not supported by all thermo packages.</li>
<li>CalcEquilibrium from the ICapeThermoEquilibriumRoutine is not supported.</li>
<li>CoolProp does not provide transport models for many compounds.</li>
<li>The function calls are NOT thread safe.</li>
<li>The code generation will NOT work for models using the thermo packages.</li>
<li>Some CapeOpen thermo packags refuse to return properties for mass basis (i.e. density).</li>
</ul>
<p>In this tutorial, we use a very simple model: a quantity of liquid (water + ethanol mixture) 
is heated using the constant input power. The model uses a thermo package to calculate the commonly
used transport properties such as specific heat capacity, thermal conductivity, dynamic viscosity
and binary diffusion coefficients. First, the low-level functions are tested for CapeOpen and 
CoolProp packages in the test_single_phase, test_two_phase, test_coolprop_single_phase functions. 
The results depend on the options selected in the CapeOpen package (equation of state, etc.).
Then, the model that uses a thermo package is simulated.</p>
<p>The plot of the specific heat capacity as a function of temperature:</p>
<a class="reference internal image-reference" href="_images/tutorial19-results.png"><img alt="_images/tutorial19-results.png" src="_images/tutorial19-results.png" style="width: 500px;" /></a>
<dl class="docutils">
<dt>Nota bene:</dt>
<dd>There is a difference between results in Windows and other platforms since 
the CapeOpen thermo packages are available only in Windows.</dd>
</dl>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial19.xml">tutorial19.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial19-rt.xml">tutorial19-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial19.html">tutorial19.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial20">
<span id="tutorial-20"></span><span id="tutorial20"></span><h2>Tutorial 20<a class="headerlink" href="#module-daetools.examples.tutorial20" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the support variable constraints available in Sundials IDA solver.
Benchmarks are available from <a class="reference external" href="https://www.mathworks.com/help/matlab/math/nonnegative-ode-solution.html">Matlab documentation</a>.</p>
<ol class="arabic">
<li><p class="first">Absolute Value Function:</p>
<p>dy/dt = -fabs(y)</p>
<p>solved on the interval [0,40] with the initial condition y(0) = 1.
The solution of this ODE decays to zero. If the solver produces a negative solution value,
the computation eventually will fail as the calculated solution diverges to -inf.
Using the constraint y &gt;= 0 resolves this problem.</p>
</li>
<li><p class="first">The Knee problem:</p>
<p>epsilon * dy/dt = (1-t)*y - y**2</p>
<p>solved on the interval [0,2] with the initial condition y(0) = 1.
The parameter epsilon is 0 &lt; epsilon &lt;&lt; 1 and in this example equal to 1e-6.
The solution follows the y = 1-x isocline for the whole interval of integration
which is incorrect. Using the constraint y &gt;= 0 resolves the problem.</p>
</li>
</ol>
<p>In DAE Tools contraints follow the Sundials IDA solver implementation and can be 
specified using the valueConstraint argument of the daeVariableType class __init__
function:</p>
<ul class="simple">
<li>eNoConstraint (default)</li>
<li>eValueGTEQ: imposes &gt;= 0 constraint</li>
<li>eValueLTEQ: imposes &lt;= 0 constraint</li>
<li>eValueGT:   imposes &gt; 0 constraint</li>
<li>eValueLT:   imposes &lt; 0 constraint</li>
</ul>
<p>and changed for individual variables using daeVariable.SetValueConstraint functions.</p>
<p>Absolute Value Function solution plot:</p>
<a class="reference internal image-reference" href="_images/tutorial20-results1.png"><img alt="_images/tutorial20-results1.png" src="_images/tutorial20-results1.png" style="width: 500px;" /></a>
<p>The Knee problem solution plot:</p>
<a class="reference internal image-reference" href="_images/tutorial20-results2.png"><img alt="_images/tutorial20-results2.png" src="_images/tutorial20-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial20.html">tutorial20.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial21">
<span id="tutorial-21"></span><span id="tutorial21"></span><h2>Tutorial 21<a class="headerlink" href="#module-daetools.examples.tutorial21" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces different methods for evaluation of equations in parallel.
Equations residuals, Jacobian matrix and sensitivity residuals can be evaluated 
in parallel using two methods</p>
<ol class="arabic">
<li><p class="first">The Evaluation Tree approach (default)</p>
<p>OpenMP API is used for evaluation in parallel.
This method is specified by setting daetools.core.equations.evaluationMode option 
in daetools.cfg to &#8220;evaluationTree_OpenMP&#8221; or setting the simulation property:</p>
<p>simulation.EvaluationMode = eEvaluationTree_OpenMP</p>
<p>numThreads controls the number of OpenMP threads in a team.
If numThreads is 0 the default number of threads is used (the number of cores in the system). 
Sequential evaluation is achieved by setting numThreads to 1.</p>
</li>
<li><p class="first">The Compute Stack approach</p>
<p>Equations can be evaluated in parallel using:</p>
<ol class="loweralpha">
<li><p class="first">OpenMP API for general purpose processors and manycore devices.</p>
<p>This method is specified by setting daetools.core.equations.evaluationMode option 
in daetools.cfg to &#8220;computeStack_OpenMP&#8221; or setting the simulation property:</p>
<p>simulation.EvaluationMode = eComputeStack_OpenMP</p>
<p>numThreads controls the number of OpenMP threads in a team.
If numThreads is 0 the default number of threads is used (the number of cores in the system). 
Sequential evaluation is achieved by setting numThreads to 1.</p>
</li>
<li><p class="first">OpenCL framework for streaming processors and heterogeneous systems.</p>
<p>This type is implemented in an external Python module pyEvaluator_OpenCL. 
It is up to one order of magnitude faster than the Evaluation Tree approach. 
However, it does not support external functions nor thermo-physical packages.</p>
<p>OpenCL evaluators can use a single or multiple OpenCL devices.
It is required to install OpenCL drivers/runtime libraries.
Intel: <a class="reference external" href="https://software.intel.com/en-us/articles/opencl-drivers">https://software.intel.com/en-us/articles/opencl-drivers</a>
AMD: <a class="reference external" href="https://support.amd.com/en-us/kb-articles/Pages/OpenCL2-Driver.aspx">https://support.amd.com/en-us/kb-articles/Pages/OpenCL2-Driver.aspx</a>
NVidia: <a class="reference external" href="https://developer.nvidia.com/opencl">https://developer.nvidia.com/opencl</a></p>
</li>
</ol>
</li>
</ol>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial21.html">tutorial21.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_adv_1">
<span id="advanced-tutorial-1"></span><span id="tutorial-adv-1"></span><h2>Advanced Tutorial 1<a class="headerlink" href="#module-daetools.examples.tutorial_adv_1" title="Permalink to this headline">¶</a></h2>
<p>This tutorial presents a user-defined simulation which instead of simply integrating
the system shows the pyQt graphical user interface (GUI) where the simulation can be
manipulated (a sort of interactive operating procedure).</p>
<p>The model in this example is the same as in the tutorial 4.</p>
<p>The simulation.Run() function is modifed to show the graphical user interface (GUI)
that allows to specify the input power of the heater (degree of freedom), a time period
for integration, and a reporting interval. The GUI also contains the temperature plot
updated in real time, as the simulation progresses.</p>
<p>The screenshot of the pyQt GUI:</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_1-screenshot.png"><img alt="_images/tutorial_adv_1-screenshot.png" src="_images/tutorial_adv_1-screenshot.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_1.xml">tutorial_adv_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_1-rt.xml">tutorial_adv_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_adv_1.html">tutorial_adv_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_adv_2">
<span id="advanced-tutorial-2"></span><span id="tutorial-adv-2"></span><h2>Advanced Tutorial 2<a class="headerlink" href="#module-daetools.examples.tutorial_adv_2" title="Permalink to this headline">¶</a></h2>
<p>This tutorial demonstrates a solution of a discretized population balance using
high resolution upwind schemes with flux limiter.</p>
<p>Reference: Qamar S., Elsner M.P., Angelov I.A., Warnecke G., Seidel-Morgenstern A. (2006)
A comparative study of high resolution schemes for solving population balances in crystallization.
Computers and Chemical Engineering 30(6-7):1119-1131.
<a class="reference external" href="http://dx.doi.org/10.1016/j.compchemeng.2006.02.012">doi:10.1016/j.compchemeng.2006.02.012</a></p>
<p>It shows a comparison between the analytical results and various discretization schemes:</p>
<ul class="simple">
<li>I order upwind scheme</li>
<li>II order central scheme</li>
<li>Cell centered finite volume method solved using the high resolution upwind scheme
(Van Leer k-interpolation with k = 1/3 and Koren flux limiter)</li>
</ul>
<p>The problem is from the section 3.1 Size-independent growth.</p>
<p>Could be also found in: Motz S., Mitrović A., Gilles E.-D. (2002)
Comparison of numerical methods for the simulation of dispersed phase systems.
Chemical Engineering Science 57(20):4329-4344.
<a class="reference external" href="http://dx.doi.org/10.1016/S0009-2509(02)00349-4">doi:10.1016/S0009-2509(02)00349-4</a></p>
<p>The comparison of number density functions between the analytical solution and the
high-resolution scheme:</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_2-results.png"><img alt="_images/tutorial_adv_2-results.png" src="_images/tutorial_adv_2-results.png" style="width: 500px;" /></a>
<p>The comparison of number density functions between the analytical solution and the
I order upwind, II order upwind and II order central difference schemes:</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_2-results2.png"><img alt="_images/tutorial_adv_2-results2.png" src="_images/tutorial_adv_2-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_2.xml">tutorial_adv_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_2-rt.xml">tutorial_adv_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_adv_2.html">tutorial_adv_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_adv_3">
<span id="advanced-tutorial-3"></span><span id="tutorial-adv-3"></span><h2>Advanced Tutorial 3<a class="headerlink" href="#module-daetools.examples.tutorial_adv_3" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces the following concepts:</p>
<ul class="simple">
<li>DAE Tools code-generators<ul>
<li>Modelica code-generator</li>
<li>gPROMS code-generator</li>
<li>FMI code-generator (for Co-Simulation)</li>
</ul>
</li>
<li>DAE Tools model-exchange capabilities:<ul>
<li>Scilab/GNU_Octave/Matlab MEX functions</li>
<li>Simulink S-functions</li>
</ul>
</li>
</ul>
<p>The model represent a simple multiplier block. It contains two inlet and two outlet ports.
The outlets values are equal to inputs values multiplied by a multiplier &#8220;m&#8221;:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>out1.y   = m1   x in1.y
out2.y[] = m2[] x in2.y[]
</pre></div>
</div>
<p>where multipliers m1 and m2[] are:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>STN Multipliers
   case variableMultipliers:
      dm1/dt   = p1
      dm2[]/dt = p2
   case constantMultipliers:
      dm1/dt   = 0
      dm2[]/dt = 0
</pre></div>
</div>
<p>(that is the multipliers can be constant or variable).</p>
<p>The ports in1 and out1 are scalar (width = 1).
The ports in2 and out2 are vectors (width = 1).</p>
<p>Achtung, Achtung!!
Notate bene:</p>
<ol class="arabic simple">
<li>Inlet ports must be DOFs (that is to have their values asssigned),
for they can&#8217;t be connected when the model is simulated outside of daetools context.</li>
<li>Only scalar output ports are supported at the moment!! (Simulink issue)</li>
</ol>
<p>The plot of the inlet &#8216;y&#8217; variable and the multiplied outlet &#8216;y&#8217; variable for
the constant multipliers (m1 = 2):</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_3-results.png"><img alt="_images/tutorial_adv_3-results.png" src="_images/tutorial_adv_3-results.png" style="width: 500px;" /></a>
<p>The plot of the inlet &#8216;y&#8217; variable and the multiplied outlet &#8216;y&#8217; variable for
the variable multipliers (dm1/dt = 10, m1(t=0) = 2):</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_3-results2.png"><img alt="_images/tutorial_adv_3-results2.png" src="_images/tutorial_adv_3-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_3.xml">tutorial_adv_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_3-rt.xml">tutorial_adv_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_adv_3.html">tutorial_adv_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_adv_4">
<span id="advanced-tutorial-4"></span><span id="tutorial-adv-4"></span><h2>Advanced Tutorial 4<a class="headerlink" href="#module-daetools.examples.tutorial_adv_4" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the OpenCS code generator.
For the given DAE Tools simulation it generates input files for OpenCS simulation,
either for a single CPU or for a parallel simulation using MPI.
The model is identical to the model in the tutorial 11.</p>
<p>The OpenCS framework currently does not support:</p>
<ul class="simple">
<li>Discontinuous equations (STNs and IFs)</li>
<li>External functions</li>
<li>Thermo-physical property packages</li>
</ul>
<p>The temperature plot (at t=100s, x=0.5128, y=*):</p>
<a class="reference internal image-reference" href="_images/tutorial_adv_4-results.png"><img alt="_images/tutorial_adv_4-results.png" src="_images/tutorial_adv_4-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_4.xml">tutorial_adv_4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_adv_4-rt.xml">tutorial_adv_4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_adv_4.html">tutorial_adv_4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_1">
<span id="code-verification-test-1"></span><span id="tutorial-cv-1"></span><h2>Code Verification Test 1<a class="headerlink" href="#module-daetools.examples.tutorial_cv_1" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Exact Solutions.</p>
<p>Here, the numerical solution and numerical sensitivities for the Constant coefficient 
first order equations are compared to the available analytical solution.</p>
<p>The sensitivity analysis is enabled and the sensitivities are reported to the data reporter.
The sensitivity data can be obtained in two ways:</p>
<ul class="simple">
<li>Directly from the DAE solver in the user-defined Run function using the
DAESolver.SensitivityMatrix property.</li>
<li>From the data reporter as any ordinary variable.</li>
</ul>
<p>The comparison between the numerical and the analytical sensitivities:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_1-results.png"><img alt="_images/tutorial_cv_1-results.png" src="_images/tutorial_cv_1-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_1.xml">tutorial_cv_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_1-rt.xml">tutorial_cv_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_1.html">tutorial_cv_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_2">
<span id="code-verification-test-2"></span><span id="tutorial-cv-2"></span><h2>Code Verification Test 2<a class="headerlink" href="#module-daetools.examples.tutorial_cv_2" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>References:</p>
<ol class="arabic simple">
<li>G. Tryggvason. Method of Manufactured Solutions, Lecture 33: Predictivity-I, 2011.
<a class="reference external" href="http://www3.nd.edu/~gtryggva/CFD-Course/2011-Lecture-33.pdf">PDF</a></li>
<li>K. Salari and P. Knupp. Code Verification by the Method of Manufactured Solutions. 
SAND2000 – 1444 (2000).
<a class="reference external" href="https://doi.org/10.2172/759450">doi:10.2172/759450</a></li>
<li>P.J. Roache. Fundamentals of Verification and Validation. Hermosa, 2009.
<a class="reference external" href="http://www.isbnsearch.org/isbn/0913478121">ISBN-10:0913478121</a></li>
</ol>
<p>The procedure for the <em>transient convection-diffusion</em> (Burger&#8217;s) equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>L(f) = df/dt + f*df/dx - D*d2f/dx2 = 0
</pre></div>
</div>
<p>is the following:</p>
<ol class="arabic">
<li><p class="first">Pick a function (q, the manufactured solution):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>q = A + sin(x + Ct)
</pre></div>
</div>
</li>
<li><p class="first">Compute the new source term (g) for the original problem:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>g = dq/dt + q*dq/dx - D*d2q/dx2
</pre></div>
</div>
</li>
<li><p class="first">Solve the original problem with the new source term:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>df/dt + f*df/dx - D*d2f/dx2 = g
</pre></div>
</div>
</li>
</ol>
<p>Since L(f) = g and g = L(q), consequently we have: f = q.
Therefore, the computed numerical solution (f) should be equal to the manufactured one (q).</p>
<p>The terms in the source g term are:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dq/dt   = C * cos(x + C*t)
dq/dx   = cos(x + C*t)
d2q/dx2 = -sin(x + C*t)
</pre></div>
</div>
<p>The equations are solved for Dirichlet boundary conditions:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>f(x=0)   = q(x=0)   = A + sin(0 + Ct)
f(x=2pi) = q(x=2pi) = A + sin(2pi + Ct)
</pre></div>
</div>
<p>Numerical vs. manufactured solution plot (no. elements = 60, t = 1.0s):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_2-results.png"><img alt="_images/tutorial_cv_2-results.png" src="_images/tutorial_cv_2-results.png" style="width: 500px;" /></a>
<p>The normalised global errors and the order of accuracy plots (no. elements = [60, 90, 120, 150], t = 1.0s):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_2-results2.png"><img alt="_images/tutorial_cv_2-results2.png" src="_images/tutorial_cv_2-results2.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_2.xml">tutorial_cv_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_2-rt.xml">tutorial_cv_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_2.html">tutorial_cv_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_3">
<span id="code-verification-test-3"></span><span id="tutorial-cv-3"></span><h2>Code Verification Test 3<a class="headerlink" href="#module-daetools.examples.tutorial_cv_3" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>References:</p>
<ol class="arabic simple">
<li>G. Tryggvason. Method of Manufactured Solutions, Lecture 33: Predictivity-I, 2011.
<a class="reference external" href="http://www3.nd.edu/~gtryggva/CFD-Course/2011-Lecture-33.pdf">PDF</a></li>
<li>K. Salari and P. Knupp. Code Verification by the Method of Manufactured Solutions. 
SAND2000 – 1444 (2000).
<a class="reference external" href="https://doi.org/10.2172/759450">doi:10.2172/759450</a></li>
<li>P.J. Roache. Fundamentals of Verification and Validation. Hermosa, 2009.
<a class="reference external" href="http://www.isbnsearch.org/isbn/0913478121">ISBN-10:0913478121</a></li>
</ol>
<p>The problem in this tutorial is identical to tutorial_cv_3. The only difference is that 
the Neumann boundary conditions are applied:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>df(x=0)/dx   = dq(x=0)/dx   = cos(0 + Ct)
df(x=2pi)/dx = dq(x=2pi)/dx = cos(2pi + Ct)
</pre></div>
</div>
<p>Numerical vs. manufactured solution plot (no. elements = 60, t = 1.0s):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_3-results.png"><img alt="_images/tutorial_cv_3-results.png" src="_images/tutorial_cv_3-results.png" style="width: 500px;" /></a>
<p>The normalised global errors and the order of accuracy plots (no. elements = [60, 90, 120, 150], t = 1.0s):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_3-results2.png"><img alt="_images/tutorial_cv_3-results2.png" src="_images/tutorial_cv_3-results2.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_3.xml">tutorial_cv_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_3-rt.xml">tutorial_cv_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_3.html">tutorial_cv_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_4">
<span id="code-verification-test-4"></span><span id="tutorial-cv-4"></span><h2>Code Verification Test 4<a class="headerlink" href="#module-daetools.examples.tutorial_cv_4" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>Reference:</p>
<ol class="arabic simple">
<li>K. Salari and P. Knupp. Code Verification by the Method of Manufactured Solutions. 
SAND2000 – 1444 (2000).
<a class="reference external" href="https://doi.org/10.2172/759450">doi:10.2172/759450</a></li>
</ol>
<p>The problem in this tutorial is the <em>transient convection-diffusion</em> equation 
distributed on a rectangular 2D domain with u and v components of velocity:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>L(u) = du/dt + (d(uu)/dx + d(uv)/dy) - ni * (d2u/dx2 + d2u/dy2) = 0
L(v) = dv/dt + (d(vu)/dx + d(vv)/dy) - ni * (d2v/dx2 + d2v/dy2) = 0
</pre></div>
</div>
<p>The manufactured solutions are:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>um = u0 * (sin(x**2 + y**2 + w0*t) + eps)
vm = v0 * (cos(x**2 + y**2 + w0*t) + eps)
</pre></div>
</div>
<p>The terms in the new sources Su and Sv are computed using the daetools derivative 
functions (dt, d and d2).</p>
<p>Again, the Dirichlet boundary conditions are used:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>u(LB, y)  = um(LB, y)
u(UB, y)  = um(UB, y)
u(x,  LB) = um(x,  LB)
u(x,  UB) = um(x,  UB)

v(LB, y)  = vm(LB, y)
v(UB, y)  = vm(UB, y)
v(x,  LB) = vm(x,  LB)
v(x,  UB) = vm(x,  UB)
</pre></div>
</div>
<p>Steady-state results (w0 = 0.0) for the u-component:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_4-u_component.png"><img alt="_images/tutorial_cv_4-u_component.png" src="_images/tutorial_cv_4-u_component.png" style="width: 500px;" /></a>
<p>Steady-state results (w0 = 0.0) for the v-component:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_4-v_component.png"><img alt="_images/tutorial_cv_4-v_component.png" src="_images/tutorial_cv_4-v_component.png" style="width: 500px;" /></a>
<p>Numerical vs. manufactured solution plot (u velocity component, 40x32 grid):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_4-results.png"><img alt="_images/tutorial_cv_4-results.png" src="_images/tutorial_cv_4-results.png" style="width: 500px;" /></a>
<p>The normalised global errors and the order of accuracy plots 
(grids 10x8, 20x16, 40x32, 80x64):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_4-results2.png"><img alt="_images/tutorial_cv_4-results2.png" src="_images/tutorial_cv_4-results2.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_4.xml">tutorial_cv_4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_4-rt.xml">tutorial_cv_4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_4.html">tutorial_cv_4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_5">
<span id="code-verification-test-5"></span><span id="tutorial-cv-5"></span><h2>Code Verification Test 5<a class="headerlink" href="#module-daetools.examples.tutorial_cv_5" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>This problem and its solution in <a class="reference external" href="https://www.comsol.com">COMSOL Multiphysics</a> software 
is described in the COMSOL blog:
<a class="reference external" href="https://www.comsol.com/blogs/verify-simulations-with-the-method-of-manufactured-solutions">Verify Simulations with the Method of Manufactured Solutions (2015)</a>.</p>
<p>Here, a 1D transient heat conduction problem in a bar of length L is solved using the FE method:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dT/dt - k/(rho*cp) * d2T/dx2 = 0, x in [0,L]
</pre></div>
</div>
<p>with the following boundary:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>T(0,t) = 500 K
T(L,t) = 500 K
</pre></div>
</div>
<p>and initial conditions:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>T(x,0) = 500 K
</pre></div>
</div>
<p>The manufactured solution is given by function u(x):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>u(x) = 500 + (x/L) * (x/L - 1) * (t/tau)
</pre></div>
</div>
<p>The new source term is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>g(x) = du/dt - k/(rho*cp) * d2u/dx2
</pre></div>
</div>
<p>The terms in the source g term are:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>du_dt   = (x/L) * (x/L - 1) * (1/tau)
d2u_dx2 = (2/(L**2)) * (t/tau)
</pre></div>
</div>
<p>Finally, the original problem with the new source term is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dT/dt - k/(rho*cp) * d2T/dx2 = g(x), x in [0,L]
</pre></div>
</div>
<p>The mesh is linear (a bar) with a length of 100 m:</p>
<a class="reference internal image-reference" href="_images/bar(0,100)-20.png"><img alt="_images/bar(0,100)-20.png" src="_images/bar(0,100)-20.png" style="width: 500px;" /></a>
<p>The comparison plots for the coarse mesh and linear elements:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_5-results-5_elements-I_order.png"><img alt="_images/tutorial_cv_5-results-5_elements-I_order.png" src="_images/tutorial_cv_5-results-5_elements-I_order.png" style="width: 400px;" /></a>
<p>The comparison plots for the coarse mesh and quadratic elements:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_5-results-5_elements-II_order.png"><img alt="_images/tutorial_cv_5-results-5_elements-II_order.png" src="_images/tutorial_cv_5-results-5_elements-II_order.png" style="width: 400px;" /></a>
<p>The comparison plots for the fine mesh and linear elements:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_5-results-20_elements-I_order.png"><img alt="_images/tutorial_cv_5-results-20_elements-I_order.png" src="_images/tutorial_cv_5-results-20_elements-I_order.png" style="width: 400px;" /></a>
<p>The comparison plots for the fine mesh and quadratic elements:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_5-results-20_elements-II_order.png"><img alt="_images/tutorial_cv_5-results-20_elements-II_order.png" src="_images/tutorial_cv_5-results-20_elements-II_order.png" style="width: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_5.xml">tutorial_cv_5.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_5-rt.xml">tutorial_cv_5-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_5.html">tutorial_cv_5.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_6">
<span id="code-verification-test-6"></span><span id="tutorial-cv-6"></span><h2>Code Verification Test 6<a class="headerlink" href="#module-daetools.examples.tutorial_cv_6" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Exact Solutions.</p>
<p>Reference (section 3.3):</p>
<ul class="simple">
<li>B. Koren. A robust upwind discretization method for advection, diffusion and source terms. 
Department of Numerical Mathematics. Report NM-R9308 (1993). 
<a class="reference external" href="http://oai.cwi.nl/oai/asset/5293/05293D.pdf">PDF</a></li>
</ul>
<p>The problem in this tutorial is 1D <em>transient convection-diffusion</em> equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc_dt + u*dc/dx - D*d2c/dc2 = 0
</pre></div>
</div>
<p>The equation is solved using the high resolution cell-centered finite volume upwind scheme
with flux limiter described in the article.</p>
<p>Numerical vs. exact solution plots (Nx = [20, 40, 80]):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_6-results.png"><img alt="_images/tutorial_cv_6-results.png" src="_images/tutorial_cv_6-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_6.xml">tutorial_cv_6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_6-rt.xml">tutorial_cv_6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_6.html">tutorial_cv_6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_7">
<span id="code-verification-test-7"></span><span id="tutorial-cv-7"></span><h2>Code Verification Test 7<a class="headerlink" href="#module-daetools.examples.tutorial_cv_7" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>Reference (section 4.2):</p>
<ul class="simple">
<li>B. Koren. A robust upwind discretization method for advection, diffusion and source terms. 
Department of Numerical Mathematics. Report NM-R9308 (1993). 
<a class="reference external" href="http://oai.cwi.nl/oai/asset/5293/05293D.pdf">PDF</a></li>
</ul>
<p>The problem in this tutorial is 1D <em>steady-state convection-diffusion</em> (Burger&#8217;s) equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>u*dc/dx - D*d2c/dc2 = 0
</pre></div>
</div>
<p>The manufactured solution is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>c(x) = 0.5 * (1 - cos(2*pi*(x-a)/(b-a))), x in [a,b]
c(x) = 0, otherwise
</pre></div>
</div>
<p>The new source term is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>s(x) = pi/(b-a) * u * sin(2*pi*(x-a)/(b-a)) - 2*(pi/(b-a))**2 * D * cos(2*pi*(x-a)/(b-a)), x in [a,b]
s(x) = 0, otherwise
</pre></div>
</div>
<p>The modified equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>u*dc/dx - D*d2c/dc2 = s(x)
</pre></div>
</div>
<p>is solved using the high resolution cell-centered finite volume upwind scheme
with flux limiter described in the article.</p>
<p>In order to obtain the consistent discretisation of the convection and the source terms 
an integral of the source term: S(x) = 1/u * Integral s(x)*dx must be calculated.
The result of integration is given as:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>S(x) = 0.5 * (1 - cos(2*pi*(x-a)/(b-a)))) - pi/(b-a) * D/u * sin(2*pi*(x-a)/(b-a))), x in [a,b]
S(x) = 0, otherwise
</pre></div>
</div>
<p>Numerical vs. manufactured solution plot (Nx=80):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_7-results.png"><img alt="_images/tutorial_cv_7-results.png" src="_images/tutorial_cv_7-results.png" style="width: 500px;" /></a>
<p>The normalised global errors and the order of accuracy plots 
for the Koren flux limiter (grids 40, 60, 80, 120):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_7-results-koren.png"><img alt="_images/tutorial_cv_7-results-koren.png" src="_images/tutorial_cv_7-results-koren.png" style="width: 800px;" /></a>
<p>The normalised global errors and the order of accuracy plots 
for the Superbee flux limiter (grids 40, 60, 80, 120):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_7-results-superbee.png"><img alt="_images/tutorial_cv_7-results-superbee.png" src="_images/tutorial_cv_7-results-superbee.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_7.xml">tutorial_cv_7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_7-rt.xml">tutorial_cv_7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_7.html">tutorial_cv_7.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_8">
<span id="code-verification-test-8"></span><span id="tutorial-cv-8"></span><h2>Code Verification Test 8<a class="headerlink" href="#module-daetools.examples.tutorial_cv_8" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Manufactured Solutions.</p>
<p>Reference (page 64):</p>
<ul class="simple">
<li>W. Hundsdorfer. Numerical Solution of Advection-Diffusion-Reaction Equations. 
Lecture notes (2000), Thomas Stieltjes Institute. 
<a class="reference external" href="http://homepages.cwi.nl/~willem/Coll_AdvDiffReac/notes.pdf">PDF</a></li>
</ul>
<p>The problem in this tutorial is 1D <em>transient convection-reaction</em> equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc/dt + dc/dx = c**2
</pre></div>
</div>
<p>The exact solution is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>c(x,t) = sin(pi*(x-t))**2 / (1 - t*sin(pi*(x-t))**2)
</pre></div>
</div>
<p>The equation is solved using the high resolution cell-centered finite volume upwind scheme
with flux limiter described in the article. The boundary and initial conditions are obtained 
from the exact solution.</p>
<p>The consistent discretisation of the convection and the source terms cannot be done
since the constant C1 in the integral of the source term:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>S(x) = 1/u * Integral s(x)*dx = u**/3 + C1 
</pre></div>
</div>
<p>is not known. Therefore, the numerical cell average is used:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Snum(x) = Integral s(x)*dx = s(i) * (x[i]-x[i-1]).
</pre></div>
</div>
<p>Numerical vs. manufactured solution plot (Nx=80):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_8-results.png"><img alt="_images/tutorial_cv_8-results.png" src="_images/tutorial_cv_8-results.png" style="width: 500px;" /></a>
<p>The normalised global errors and the order of accuracy plots 
for the Koren flux limiter (grids 40, 60, 80, 120):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_8-results-koren.png"><img alt="_images/tutorial_cv_8-results-koren.png" src="_images/tutorial_cv_8-results-koren.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_8.xml">tutorial_cv_8.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_8-rt.xml">tutorial_cv_8-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_8.html">tutorial_cv_8.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_9">
<span id="code-verification-test-9"></span><span id="tutorial-cv-9"></span><h2>Code Verification Test 9<a class="headerlink" href="#module-daetools.examples.tutorial_cv_9" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Exact Solutions (Solid Body Rotation problem).</p>
<p>Reference (section 4.4.6.1 Solid Body Rotation):</p>
<ul class="simple">
<li>D. Kuzmin (2010). A Guide to Numerical Methods for Transport Equations. 
<a class="reference external" href="http://www.mathematik.uni-dortmund.de/~kuzmin/Transport.pdf">PDF</a></li>
</ul>
<p>Solid body rotation illustrates the ability of a numerical scheme to transport initial
data without distortion. Here, a 2D transient convection problem in a rectangular 
(0,1)x(0,1) domain is solved using the FE method:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc/dt + div(u*c) = 0, in Omega = (0,1)x(0,1)
</pre></div>
</div>
<p>The initial conditions define a conical body which is rotated counterclockwise around
the point (0.5, 0.5) using the velocity field u = (0.5 - y, x - 0.5). 
The cone is defined by the following equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>r0 = 0.15
(x0, y0) = (0.5, 0.25)
c(x,y,0) = 1 - (1/r0) * sqrt((x-x0)**2 + (y-y0)**2)
</pre></div>
</div>
<p>After t = 2pi the body should arrive at the starting position.</p>
<p>Homogeneous Dirichlet boundary conditions are prescribed at all four edges:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>c(x,y,t) = 0.0
</pre></div>
</div>
<p>The mesh is a square (0,1)x(0,1):</p>
<a class="reference internal image-reference" href="_images/square(0,1)x(0,1)-64x64.png"><img alt="_images/square(0,1)x(0,1)-64x64.png" src="_images/square(0,1)x(0,1)-64x64.png" style="width: 300px;" /></a>
<p>The solution plot at t = 0 and t = 2pi (96x96 grid):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_9-results1.png"><img alt="_images/tutorial_cv_9-results1.png" src="_images/tutorial_cv_9-results1.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="_images/tutorial_cv_9-results2.png"><img alt="_images/tutorial_cv_9-results2.png" src="_images/tutorial_cv_9-results2.png" style="height: 400px;" /></a>
<p>Animations for 32x32 and 96x96 grids:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_9-animation-32x32.gif"><img alt="_images/tutorial_cv_9-animation-32x32.gif" src="_images/tutorial_cv_9-animation-32x32.gif" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="_images/tutorial_cv_9-animation-96x96.gif"><img alt="_images/tutorial_cv_9-animation-96x96.gif" src="_images/tutorial_cv_9-animation-96x96.gif" style="height: 400px;" /></a>
<p>It can be observed that the shape of the cone is preserved. Also, since the above
equation is hyperbolic some oscillations in the solution out of the cone appear,
which are more pronounced for coarser grids.
This problem was resolved in the original example using the flux linearisation technique.</p>
<p>The normalised global errors and the order of accuracy plots 
(no. elements = [32x32, 64x64, 96x96, 128x128], t = 2pi):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_9-results3.png"><img alt="_images/tutorial_cv_9-results3.png" src="_images/tutorial_cv_9-results3.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_9.xml">tutorial_cv_9.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_9-rt.xml">tutorial_cv_9-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_9.html">tutorial_cv_9.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_10">
<span id="code-verification-test-10"></span><span id="tutorial-cv-10"></span><h2>Code Verification Test 10<a class="headerlink" href="#module-daetools.examples.tutorial_cv_10" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Exact Solutions (Rotating Gaussian Hill problem).</p>
<p>Reference (section 4.4.6.3 Convection-Diffusion):</p>
<ul class="simple">
<li>D. Kuzmin (2010). A Guide to Numerical Methods for Transport Equations. 
<a class="reference external" href="http://www.mathematik.uni-dortmund.de/~kuzmin/Transport.pdf">PDF</a></li>
</ul>
<p>Here, a 2D transient convection-diffusion problem in a rectangular (-1,1)x(-1,1) domain 
is solved using the FE method:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc/dt + div(u*c) - eps*nabla(c) = 0, in Omega = (-1,1)x(-1,1)
</pre></div>
</div>
<p>The exact solution is given by the following function:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>(x0, y0) = (0.0, 0.5)
x_bar(t) = x0*cos(t) - y0*sin(t)
y_bar(t) = -x0*sin(t) + y0*cos(t)
r2(x,y,t) = (x-x_bar(t))**2 + (y-y_bar(t))**2

c_exact(x,y,t) = 1.0 / (4*pi*eps*t) * exp(-r2(x,y,t) / (4*eps*t))
</pre></div>
</div>
<p>The initial conditions define a Gaussian hill which is rotated counterclockwise around
the point (0.0, 0.0) using the velocity field u = (-y, x). Since at t = 0 the 
value of c_exact is the Dirac delta function it is better to start the simulation at t &gt; 0.
Therefore, the simulation is started and t = pi/2 by reinitialising variable c to:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>c(x,y,pi/2) = c_exact(x,y,pi/2)
</pre></div>
</div>
<p>At t = 5/2 pi the peak smeared by the diffusion should arrive at the starting position.</p>
<p>Homogeneous Dirichlet boundary conditions are prescribed at all four edges:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>c(x,y,t) = 0.0
</pre></div>
</div>
<p>The mesh is a rectangle (-1,1)x(-1,1):</p>
<a class="reference internal image-reference" href="_images/square(-1,1)x(-1,1)-64x64.png"><img alt="_images/square(-1,1)x(-1,1)-64x64.png" src="_images/square(-1,1)x(-1,1)-64x64.png" style="width: 300px;" /></a>
<p>The solution plots at t = pi/2 (the initial peak) and t = 5/2pi (96x96 grid):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_10-results1.png"><img alt="_images/tutorial_cv_10-results1.png" src="_images/tutorial_cv_10-results1.png" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="_images/tutorial_cv_10-results2.png"><img alt="_images/tutorial_cv_10-results2.png" src="_images/tutorial_cv_10-results2.png" style="height: 400px;" /></a>
<p>Animations for 32x32 and 96x96 grids:</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_10-animation-32x32.gif"><img alt="_images/tutorial_cv_10-animation-32x32.gif" src="_images/tutorial_cv_10-animation-32x32.gif" style="height: 400px;" /></a>
<a class="reference internal image-reference" href="_images/tutorial_cv_10-animation-96x96.gif"><img alt="_images/tutorial_cv_10-animation-96x96.gif" src="_images/tutorial_cv_10-animation-96x96.gif" style="height: 400px;" /></a>
<p>Again, some low-magnitude oscillations in the solution appear, which are more pronounced 
for coarser grids.
In the original example this problem was resolved using the flux linearisation technique.</p>
<p>The normalised global errors and the order of accuracy plots 
(no. elements = [32x32, 64x64, 96x96, 128x128], t = 5/2pi):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_10-results3.png"><img alt="_images/tutorial_cv_10-results3.png" src="_images/tutorial_cv_10-results3.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_10.xml">tutorial_cv_10.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_10-rt.xml">tutorial_cv_10-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_10.html">tutorial_cv_10.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_cv_11">
<span id="code-verification-test-11"></span><span id="tutorial-cv-11"></span><h2>Code Verification Test 11<a class="headerlink" href="#module-daetools.examples.tutorial_cv_11" title="Permalink to this headline">¶</a></h2>
<p>Code verification using the Method of Exact Solutions.</p>
<p>The problem is identical to the problem in the tutorial_cv_6.
The only difference is that the flow is reversed to test the high resolution scheme
for the reversed flow mode.</p>
<p>Numerical vs. exact solution plots (Nx = [20, 40, 80]):</p>
<a class="reference internal image-reference" href="_images/tutorial_cv_11-results.png"><img alt="_images/tutorial_cv_11-results.png" src="_images/tutorial_cv_11-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_11.xml">tutorial_cv_11.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_cv_11-rt.xml">tutorial_cv_11-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_cv_11.html">tutorial_cv_11.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_1">
<span id="tutorial-deal-ii-1"></span><span id="tutorial-dealii-1"></span><h2>Tutorial deal.II 1<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_1" title="Permalink to this headline">¶</a></h2>
<p>An introductory example of the support for Finite Elements in daetools.
The basic idea is to use an external library to perform all low-level tasks such as
management of mesh elements, degrees of freedom, matrix assembly, management of
boundary conditions etc. deal.II library (www.dealii.org) is employed for these tasks.
The mass and stiffness matrices and the load vector assembled in deal.II library are
used to generate a set of algebraic/differential equations in the following form:
[Mij]{dx/dt} + [Aij]{x} = {Fi}.
Specification of additional equations such as surface/volume integrals are also available.
The numerical solution of the resulting ODA/DAE system is performed in daetools
together with the rest of the model equations.</p>
<p>The unique feature of this approach is a capability to use daetools variables
to specify boundary conditions, time varying coefficients and non-linear terms,
and evaluate quantities such as surface/volume integrals.
This way, the finite element model is fully integrated with the rest of the model
and multiple FE systems can be created and coupled together.
In addition, non-linear and DAE finite element systems are automatically supported.</p>
<p>In this tutorial the simple transient heat conduction problem is solved using
the finite element method:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dT/dt - kappa/(rho*cp)*nabla^2(T) = g(T) in Omega
</pre></div>
</div>
<p>The mesh is rectangular with two holes, similar to the mesh in step-49 deal.II example:</p>
<a class="reference internal image-reference" href="_images/step-49.png"><img alt="" src="_images/step-49.png" style="width: 400px;" /></a>
<p>Dirichlet boundary conditions are set to 300 K on the outer rectangle,
350 K on the inner ellipse and 250 K on the inner diamond.</p>
<p>The temperature plot at t = 500s (generated in VisIt):</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_1-results.png"><img alt="_images/tutorial_dealii_1-results.png" src="_images/tutorial_dealii_1-results.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_1-animation.gif"><img alt="_images/tutorial_dealii_1-animation.gif" src="_images/tutorial_dealii_1-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_1.xml">tutorial_dealii_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_1-rt.xml">tutorial_dealii_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_1.html">tutorial_dealii_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_2">
<span id="tutorial-deal-ii-2"></span><span id="tutorial-dealii-2"></span><h2>Tutorial deal.II 2<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_2" title="Permalink to this headline">¶</a></h2>
<p>In this example a simple transient heat convection-diffusion equation is solved.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dT/dt - kappa/(rho*cp)*nabla^2(T) + nabla.(uT) = g(T) in Omega
</pre></div>
</div>
<p>The fluid flows from the left side to the right with constant velocity of 0.01 m/s.
The inlet temperature for 0.2 &lt;= y &lt;= 0.3 is iven by the following expression:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>T_left = T_base + T_offset*|sin(pi*t/25)| on dOmega
</pre></div>
</div>
<p>creating a bubble-like regions of higher temperature that flow towards the right end
and slowly diffuse into the bulk flow of the fluid due to the heat conduction.</p>
<p>The mesh is rectangular with the refined elements close to the left/right ends:</p>
<a class="reference internal image-reference" href="_images/rect(1.5,0.5)-100x50.png"><img alt="_images/rect(1.5,0.5)-100x50.png" src="_images/rect(1.5,0.5)-100x50.png" style="width: 500px;" /></a>
<p>The temperature plot at t = 500s:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_2-results.png"><img alt="_images/tutorial_dealii_2-results.png" src="_images/tutorial_dealii_2-results.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_2-animation.gif"><img alt="_images/tutorial_dealii_2-animation.gif" src="_images/tutorial_dealii_2-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_2.xml">tutorial_dealii_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_2-rt.xml">tutorial_dealii_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_2.html">tutorial_dealii_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_3">
<span id="tutorial-deal-ii-3"></span><span id="tutorial-dealii-3"></span><h2>Tutorial deal.II 3<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_3" title="Permalink to this headline">¶</a></h2>
<p>In this example the Cahn-Hilliard equation is solved using the finite element method.
This equation describes the process of phase separation, where two components of a
binary mixture separate and form domains pure in each component.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc/dt - D*nabla^2(mu) = 0, in Omega
mu = c^3 - c - gamma*nabla^2(c)
</pre></div>
</div>
<p>The mesh is a simple square (0-100)x(0-100):</p>
<a class="reference internal image-reference" href="_images/square.png"><img alt="_images/square.png" src="_images/square.png" style="width: 300px;" /></a>
<p>The concentration plot at t = 500s:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_3-results.png"><img alt="_images/tutorial_dealii_3-results.png" src="_images/tutorial_dealii_3-results.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_3-animation.gif"><img alt="_images/tutorial_dealii_3-animation.gif" src="_images/tutorial_dealii_3-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_3.xml">tutorial_dealii_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_3-rt.xml">tutorial_dealii_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_3.html">tutorial_dealii_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_4">
<span id="tutorial-deal-ii-4"></span><span id="tutorial-dealii-4"></span><h2>Tutorial deal.II 4<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_4" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial the transient heat conduction problem is solved using
the finite element method:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dT/dt - kappa * nabla^2(Τ) = g in Omega
</pre></div>
</div>
<p>The mesh is a pipe submerged into water receiving the heat of the sun at the
45 degrees from the top-left direction, the heat from the suroundings and
having the constant temperature of the inner tube.
The boundary conditions are thus:</p>
<ul class="simple">
<li>[at boundary ID=0] Sun shine at 45 degrees, gradient heat flux = 2 kW/m**2 in direction n = (1,-1)</li>
<li>[at boundary ID=1] Outer surface where y &lt;= -0.5, constant flux of 2 kW/m**2</li>
<li>[at boundary ID=2] Inner tube: constant temperature of 300 K</li>
</ul>
<p>The pipe mesh is given below:</p>
<a class="reference internal image-reference" href="_images/pipe.png"><img alt="_images/pipe.png" src="_images/pipe.png" style="width: 300px;" /></a>
<p>The temperature plot at t = 3600s:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_4-results.png"><img alt="_images/tutorial_dealii_4-results.png" src="_images/tutorial_dealii_4-results.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_4-animation.gif"><img alt="_images/tutorial_dealii_4-animation.gif" src="_images/tutorial_dealii_4-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_4.xml">tutorial_dealii_4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_4-rt.xml">tutorial_dealii_4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_4.html">tutorial_dealii_4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_5">
<span id="tutorial-deal-ii-5"></span><span id="tutorial-dealii-5"></span><h2>Tutorial deal.II 5<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_5" title="Permalink to this headline">¶</a></h2>
<p>In this example a simple flow through porous media is solved (deal.II step-20).</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>K^{-1} u + nabla(p) = 0 in Omega
-div(u) = -f in Omega
p = g on dOmega
</pre></div>
</div>
<p>The mesh is a simple square:</p>
<a class="reference internal image-reference" href="_images/square(-1,1)x(-1,1)-50x50.png"><img alt="_images/square(-1,1)x(-1,1)-50x50.png" src="_images/square(-1,1)x(-1,1)-50x50.png" style="width: 300px;" /></a>
<p>The velocity magnitude plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_5-results.png"><img alt="_images/tutorial_dealii_5-results.png" src="_images/tutorial_dealii_5-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_5.xml">tutorial_dealii_5.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_5-rt.xml">tutorial_dealii_5-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_5.html">tutorial_dealii_5.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_6">
<span id="tutorial-deal-ii-6"></span><span id="tutorial-dealii-6"></span><h2>Tutorial deal.II 6<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_6" title="Permalink to this headline">¶</a></h2>
<p>A simple steady-state diffusion and first-order reaction in an irregular catalyst shape
(Proc. 6th Int. Conf. on Mathematical Modelling, Math. Comput. Modelling, Vol. 11, 375-319, 1988)
applying Dirichlet and Robin type of boundary conditions.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>D_eA * nabla^2(C_A) - k_r * C_A = 0 in Omega
D_eA * nabla(C_A) = k_m * (C_A - C_Ab) on dOmega1
C_A = C_Ab on dOmega2
</pre></div>
</div>
<p>The catalyst pellet mesh:</p>
<a class="reference internal image-reference" href="_images/ssdr.png"><img alt="_images/ssdr.png" src="_images/ssdr.png" style="width: 400px;" /></a>
<p>The concentration plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_6-results1.png"><img alt="_images/tutorial_dealii_6-results1.png" src="_images/tutorial_dealii_6-results1.png" style="width: 500px;" /></a>
<p>The concentration plot for Ca=Cab on all boundaries:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_6-results2.png"><img alt="_images/tutorial_dealii_6-results2.png" src="_images/tutorial_dealii_6-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_6.xml">tutorial_dealii_6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_6-rt.xml">tutorial_dealii_6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_6.html">tutorial_dealii_6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_7">
<span id="tutorial-deal-ii-7"></span><span id="tutorial-dealii-7"></span><h2>Tutorial deal.II 7<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_7" title="Permalink to this headline">¶</a></h2>
<p>In this example 2D transient Stokes flow driven by the differences in buoyancy caused
by the temperature differences in the fluid is solved 
(<a class="reference external" href="https://www.dealii.org/8.5.0/doxygen/deal.II/step_31.html">deal.II step-31</a>).</p>
<p>The differences to the original problem are that the grid is not adaptive and no 
stabilisation method is used.</p>
<p>The problem can be described using the Stokes equations:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>-div(2 * eta * eps(u)) + nabla(p) = -rho * beta * g * T in Omega
-div(u) = 0 in Omega
dT/dt + div(u * T) - div(k * nabla(T)) = gamma in Omega
</pre></div>
</div>
<p>The mesh is a simple square (0,1)x(0,1):</p>
<a class="reference internal image-reference" href="_images/square(0,1)x(0,1)-50x50.png"><img alt="_images/square(0,1)x(0,1)-50x50.png" src="_images/square(0,1)x(0,1)-50x50.png" style="width: 300px;" /></a>
<p>The temperature and the velocity vectors plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_7-results.png"><img alt="_images/tutorial_dealii_7-results.png" src="_images/tutorial_dealii_7-results.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_7-animation.gif"><img alt="_images/tutorial_dealii_7-animation.gif" src="_images/tutorial_dealii_7-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_7.xml">tutorial_dealii_7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_7-rt.xml">tutorial_dealii_7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_7.html">tutorial_dealii_7.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_dealii_8">
<span id="tutorial-deal-ii-8"></span><span id="tutorial-dealii-8"></span><h2>Tutorial deal.II 8<a class="headerlink" href="#module-daetools.examples.tutorial_dealii_8" title="Permalink to this headline">¶</a></h2>
<p>In this example a small parallel-plate reactor with an active surface is modelled.</p>
<p>This problem and its solution in <a class="reference external" href="https://www.comsol.com">COMSOL Multiphysics</a> software 
is described in the Application Gallery: <a class="reference external" href="https://www.comsol.com/model/transport-and-adsorption-5">Transport and Adsorption (id=5)</a>.</p>
<p>The transport in the bulk of the reactor is described by a convection-diffusion equation:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc/dt - D*nabla^2(c) + div(uc) = 0 in Omega
</pre></div>
</div>
<p>The material balance for the surface, including surface diffusion and the reaction rate is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>dc_s/dt - Ds*nabla^2(c_s) = -k_ads * c * (Gamma_s - c_s) + k_des * c_s in Omega_s
</pre></div>
</div>
<p>For the bulk, the boundary condition at the active surface couples the rate of the reaction
at the surface with the flux of the reacting species and the concentration of the adsorbed
species and bulk species:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>n⋅(-D*nabla(c) + c*u) = -k_ads*c*(Gamma_s - c_s) + k_des*c_s
</pre></div>
</div>
<p>The boundary conditions for the surface species are insulating conditions.</p>
<p>The problem is modelled using two coupled Finite Element systems: 
2D for bulk flow and 1D for the active surface. 
The linear interpolation is used to determine the bulk flow and active surface concentrations
at the interface.</p>
<p>The mesh is rectangular with the refined elements close to the left/right ends:</p>
<a class="reference internal image-reference" href="_images/parallel_plate_reactor.png"><img alt="_images/parallel_plate_reactor.png" src="_images/parallel_plate_reactor.png" style="height: 400px;" /></a>
<p>The cs plot at t = 2s:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_8-results.png"><img alt="_images/tutorial_dealii_8-results.png" src="_images/tutorial_dealii_8-results.png" style="height: 400px;" /></a>
<p>The c plot at t = 2s:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_8-results2.png"><img alt="_images/tutorial_dealii_8-results2.png" src="_images/tutorial_dealii_8-results2.png" style="height: 400px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_dealii_8-animation.gif"><img alt="_images/tutorial_dealii_8-animation.gif" src="_images/tutorial_dealii_8-animation.gif" style="height: 400px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_8.xml">tutorial_dealii_8.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_dealii_8-rt.xml">tutorial_dealii_8-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_dealii_8.html">tutorial_dealii_8.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_1">
<span id="chem-eng-example-1"></span><span id="tutorial-che-1"></span><h2>Chem. Eng. Example 1<a class="headerlink" href="#module-daetools.examples.tutorial_che_1" title="Permalink to this headline">¶</a></h2>
<p>Continuously Stirred Tank Reactor with energy balance and Van de Vusse reactions:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span> A -&gt; B -&gt; C
2A -&gt; D
</pre></div>
</div>
<p>Reference: G.A. Ridlehoover, R.C. Seagrave. Optimization of Van de Vusse Reaction Kinetics
Using Semibatch Reactor Operation, Ind. Eng. Chem. Fundamen. 1973;12(4):444-447.
<a class="reference external" href="https://doi.org/10.1021/i160048a700">doi:10.1021/i160048a700</a></p>
<p>The concentrations plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_1-results.png"><img alt="_images/tutorial_che_1-results.png" src="_images/tutorial_che_1-results.png" style="width: 500px;" /></a>
<p>The temperatures plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_1-results2.png"><img alt="_images/tutorial_che_1-results2.png" src="_images/tutorial_che_1-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_1.xml">tutorial_che_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_1-rt.xml">tutorial_che_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_1.html">tutorial_che_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_2">
<span id="chem-eng-example-2"></span><span id="tutorial-che-2"></span><h2>Chem. Eng. Example 2<a class="headerlink" href="#module-daetools.examples.tutorial_che_2" title="Permalink to this headline">¶</a></h2>
<p>Binary distillation column model.</p>
<p>Reference: J. Hahn, T.F. Edgar. An improved method for nonlinear model reduction using
balancing of empirical gramians. Computers and Chemical Engineering 2002; 26:1379-1397.
<a class="reference external" href="http://dx.doi.org/10.1016/S0098-1354(02)00120-5">doi:10.1016/S0098-1354(02)00120-5</a></p>
<p>The liquid fraction after 120 min (x(reboiler)=0.935420, x(condenser)=0.064581):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_2-results.png"><img alt="_images/tutorial_che_2-results.png" src="_images/tutorial_che_2-results.png" style="width: 500px;" /></a>
<p>The liquid fraction in the reboiler (tray 1) and in the condenser (tray 32):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_2-results2.png"><img alt="_images/tutorial_che_2-results2.png" src="_images/tutorial_che_2-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_2.xml">tutorial_che_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_2-rt.xml">tutorial_che_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_2.html">tutorial_che_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_3">
<span id="chem-eng-example-3"></span><span id="tutorial-che-3"></span><h2>Chem. Eng. Example 3<a class="headerlink" href="#module-daetools.examples.tutorial_che_3" title="Permalink to this headline">¶</a></h2>
<p>Batch reactor seeded crystallisation using the method of moments.</p>
<p>References (model equations and input parameters):</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. (2016) Application of the Lagrangian Meshfree Approach
to Modelling of Batch Crystallisation: Part I - Modelling of Stirred Tank Hydrodynamics.
Chemical Engineering Science 145:317-328.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ces.2015.08.052">doi:10.1016/j.ces.2015.08.052</a></li>
<li>Mitchell N.A., O&#8217;Ciardha C.T., Frawley P.J. (2011) Estimation of the growth kinetics
for the cooling crystallisation of paracetamol and ethanol solutions.
Journal of Crystal Growth 328:39-49.
<a class="reference external" href="http://dx.doi.org/10.1016/j.jcrysgro.2011.06.016">doi:10.1016/j.jcrysgro.2011.06.016</a></li>
</ul>
<p>The main assumptions:</p>
<ul class="simple">
<li>Seeded crystallisation</li>
<li>Ideal mixing</li>
<li>Fixed cooling rate</li>
<li>Size independent growth</li>
</ul>
<p>Solubility of Paracetamol in ethanol:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>---------------------------------------------------------
Temperature       Solubility          Solubility 
     C        kg Parac./kg EtOH   mol Parac./m3 EtOH
---------------------------------------------------------
      0           0.11362                593.0387
     10           0.14128                737.4215
     20           0.17568                916.9562
     30           0.21845                1140.2008
     40           0.27163                1417.7972
     50           0.33777                1762.9779
     60           0.42000                2192.1973
---------------------------------------------------------
</pre></div>
</div>
<p>The supersaturation plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results.png"><img alt="_images/tutorial_che_3-results.png" src="_images/tutorial_che_3-results.png" style="width: 500px;" /></a>
<p>The concentration plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results2.png"><img alt="_images/tutorial_che_3-results2.png" src="_images/tutorial_che_3-results2.png" style="width: 500px;" /></a>
<p>The recovery plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results3.png"><img alt="_images/tutorial_che_3-results3.png" src="_images/tutorial_che_3-results3.png" style="width: 500px;" /></a>
<p>The yield plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results4.png"><img alt="_images/tutorial_che_3-results4.png" src="_images/tutorial_che_3-results4.png" style="width: 500px;" /></a>
<p>The total number of crystals plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_3-results5.png"><img alt="_images/tutorial_che_3-results5.png" src="_images/tutorial_che_3-results5.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_3.xml">tutorial_che_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_3-rt.xml">tutorial_che_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_3.html">tutorial_che_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_4">
<span id="chem-eng-example-4"></span><span id="tutorial-che-4"></span><h2>Chem. Eng. Example 4<a class="headerlink" href="#module-daetools.examples.tutorial_che_4" title="Permalink to this headline">¶</a></h2>
<p>This example shows a comparison between the analytical results and the discretised
population balance equations results solved using the cell centered finite volume method
employing the high resolution upwind scheme (Van Leer k-interpolation with k = 1/3) and
a range of flux limiters.</p>
<p>This tutorial can be run from the console only.</p>
<p>The problem is from the section 4.1.1 Size-independent growth I of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. Application of the Lagrangian Meshfree Approach to
Modelling of Batch Crystallisation: Part II – An Efficient Solution of Integrated CFD
and Population Balance Equations. Preprints 2016, 20161100128.
<a class="reference external" href="http://dx.doi.org/10.20944/preprints201611.0012.v1">doi:10.20944/preprints201611.0012.v1</a></li>
</ul>
<p>and also from the section 3.1 Size-independent growth of the following article:</p>
<ul class="simple">
<li>Qamar S., Elsner M.P., Angelov I.A., Warnecke G., Seidel-Morgenstern A. (2006)
A comparative study of high resolution schemes for solving population balances in crystallization.
Computers and Chemical Engineering 30(6-7):1119-1131.
<a class="reference external" href="http://dx.doi.org/10.1016/j.compchemeng.2006.02.012">doi:10.1016/j.compchemeng.2006.02.012</a></li>
</ul>
<p>The growth-only crystallisation process was considered with the constant growth rate
of 1μm/s and the following initial number density function:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>n(L,0): 1E10, if 10μm &lt; L &lt; 20μm
           0, otherwise
</pre></div>
</div>
<p>The crystal size in the range of [0, 100]μm was discretised into 100 elements.
The analytical solution in this case is equal to the initial profile translated right
in time by a distance Gt (the growth rate multiplied by the time elapsed in the process).</p>
<p>The flux limiters used in the model are:</p>
<ul class="simple">
<li>HCUS</li>
<li>HQUICK</li>
<li>Koren</li>
<li>monotinized_central</li>
<li>minmod</li>
<li>Osher</li>
<li>ospre</li>
<li>smart</li>
<li>superbee</li>
<li>Sweby</li>
<li>UMIST</li>
<li>vanAlbada1</li>
<li>vanAlbada2</li>
<li>vanLeer</li>
<li>vanLeer_minmod</li>
</ul>
<p>Comparison of L1- and L2-norms (ni_HR - ni_analytical):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>--------------------------------------
         Scheme  L1         L2
--------------------------------------
       superbee  1.786e+10  7.016e+09
          Sweby  2.817e+10  8.614e+09
          Koren  3.015e+10  9.293e+09
          smart  2.961e+10  9.326e+09
             MC  3.258e+10  9.807e+09
           HCUS  3.638e+10  1.001e+10
         HQUICK  3.622e+10  1.005e+10
  vanLeerMinmod  3.581e+10  1.011e+10
        vanLeer  3.874e+10  1.059e+10
          ospre  4.139e+10  1.094e+10
          UMIST  4.363e+10  1.136e+10
          Osher  4.579e+10  1.156e+10
     vanAlbada1  4.574e+10  1.157e+10
         minmod  5.653e+10  1.325e+10
     vanAlbada2  5.456e+10  1.331e+10
 -------------------------------------
</pre></div>
</div>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Superbee flux limiter at t=60s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-results.png"><img alt="_images/tutorial_che_4-results.png" src="_images/tutorial_che_4-results.png" style="width: 500px;" /></a>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Koren flux limiter at t=60s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-results2.png"><img alt="_images/tutorial_che_4-results2.png" src="_images/tutorial_che_4-results2.png" style="width: 500px;" /></a>
<p>Animation:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_4-animation.gif"><img alt="_images/tutorial_che_4-animation.gif" src="_images/tutorial_che_4-animation.gif" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_4.html">tutorial_che_4.py</a></td>
</tr>
<tr class="row-even"><td>Analytical solution</td>
<td><a class="reference external" href="./examples/fl_analytical.html">fl_analytical.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_5">
<span id="chem-eng-example-5"></span><span id="tutorial-che-5"></span><h2>Chem. Eng. Example 5<a class="headerlink" href="#module-daetools.examples.tutorial_che_5" title="Permalink to this headline">¶</a></h2>
<p>Similar to the chem. eng. example 4, this example shows a comparison between the analytical
results and the discretised population balance equations results solved using the cell
centered finite volume method employing the high resolution upwind scheme (Van Leer
k-interpolation with k = 1/3) and a range of flux limiters.</p>
<p>This tutorial can be run from the console only.</p>
<p>The problem is from the section 4.1.2 Size-independent growth II of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Frawley P.J. Application of the Lagrangian Meshfree Approach to
Modelling of Batch Crystallisation: Part II – An Efficient Solution of Integrated CFD
and Population Balance Equations. Preprints 2016, 20161100128.
<a class="reference external" href="http://dx.doi.org/10.20944/preprints201611.0012.v1">doi:10.20944/preprints201611.0012.v1</a></li>
</ul>
<p>and also from the section 3.2 Size-independent growth of the following article:</p>
<ul class="simple">
<li>Qamar S., Elsner M.P., Angelov I.A., Warnecke G., Seidel-Morgenstern A. (2006)
A comparative study of high resolution schemes for solving population balances in crystallization.
Computers and Chemical Engineering 30(6-7):1119-1131.
<a class="reference external" href="http://dx.doi.org/10.1016/j.compchemeng.2006.02.012">doi:10.1016/j.compchemeng.2006.02.012</a></li>
</ul>
<p>Again, the growth-only crystallisation process was considered with the constant growth rate
of 0.1μm/s and with the different initial number density function:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>n(L,0):                      0, if        L &lt;= 2.0μm
                          1E10, if  2μm &lt; L &lt;= 10μm (region I)
                             0, if 10μm &lt; L &lt;= 18μm
      1E10*cos^2(pi*(L-26)/64), if 18μm &lt; L &lt;= 34μm (region II)
                             0, if 34μm &lt; L &lt;= 42μm
      1E10*sqrt(1-(L-50)^2/64), if 42μm &lt; L &lt;= 58μm (region III)
                             0, if 58μm &lt; L &lt;= 66μm
1E10*exp(-(L-70)^2/(2sigma^2)), if 66μm &lt; L &lt;= 74μm (region IV)
                             0, if 74μm &lt; L
</pre></div>
</div>
<p>The crystal size in the range of [0, 100]μm was discretised into 200 elements.
The analytical solution in this case is equal to the initial profile translated right
in time by a distance Gt (the growth rate multiplied by the time elapsed in the process).</p>
<p>Comparison of L1- and L2-norms (ni_HR - ni_analytical):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>-------------------------------------
        Scheme  L1         L2
-------------------------------------
      superbee  4.464e+10  1.015e+10
         smart  4.727e+10  1.120e+10
         Koren  4.861e+10  1.141e+10
         Sweby  5.435e+10  1.142e+10
            MC  5.129e+10  1.162e+10
        HQUICK  5.531e+10  1.194e+10
          HCUS  5.528e+10  1.194e+10
 vanLeerMinmod  5.600e+10  1.202e+10
       vanLeer  5.814e+10  1.225e+10
         ospre  6.131e+10  1.252e+10
         UMIST  6.181e+10  1.259e+10
         Osher  6.690e+10  1.275e+10
    vanAlbada1  6.600e+10  1.281e+10
        minmod  7.751e+10  1.360e+10
    vanAlbada2  7.901e+10  1.413e+10
-------------------------------------
</pre></div>
</div>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Superbee flux limiter at t=100s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_5-results.png"><img alt="_images/tutorial_che_5-results.png" src="_images/tutorial_che_5-results.png" style="width: 500px;" /></a>
<p>The comparison of number density functions between the analytical solution and the
solution obtained using high-resolution scheme with the Koren flux limiter at t=100s:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_5-results2.png"><img alt="_images/tutorial_che_5-results2.png" src="_images/tutorial_che_5-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_5.html">tutorial_che_5.py</a></td>
</tr>
<tr class="row-even"><td>Analytical solution</td>
<td><a class="reference external" href="./examples/fl_analytical.html">fl_analytical.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_6">
<span id="chem-eng-example-6"></span><span id="tutorial-che-6"></span><h2>Chem. Eng. Example 6<a class="headerlink" href="#module-daetools.examples.tutorial_che_6" title="Permalink to this headline">¶</a></h2>
<p>Model of a lithium-ion battery based on porous electrode theory as developed
by John Newman and coworkers. In particular, the equations here are based on a summary
of the methodology by Karen E. Thomas, John Newman, and Robert M. Darling,</p>
<p>Thomas K., Newman J., Darling R. (2002). Mathematical Modeling of Lithium Batteries
in Advances in Lithium-ion Batteries. Springer US. 345-392.
<a class="reference external" href="http://dx.doi.org/10.1007/0-306-47508-1_13">doi:10.1007/0-306-47508-1_13</a></p>
<p>A few simplifications have been made rather than implementing the more complete model described there.
For example, the following assumptions have (currently) been made:</p>
<ul class="simple">
<li>two porous electrodes are used rather than providing the option for a &#8220;half cell&#8221; in which
one electrode is lithium foil.</li>
<li>conductivity in the electron-conducting phase is infinite</li>
<li>constant exchange current density in Butler-Volmer reaction expression</li>
<li>no electrolyte convection</li>
<li>constant and uniform solvent concentration (ions vary according to concentrated solution theory)</li>
<li>monodisperse particles in electrode</li>
<li>no volume occupied by binder, filler, etc. in the electrode</li>
</ul>
<p>The up to date version of the model is available at Raymond&#8217;s GitHub repository:
<a class="reference external" href="https://github.com/raybsmith/daetools-example-battery">https://github.com/raybsmith/daetools-example-battery</a>.</p>
<p>The voltage plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_6-results.png"><img alt="_images/tutorial_che_6-results.png" src="_images/tutorial_che_6-results.png" style="width: 500px;" /></a>
<p>The current plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_6-results2.png"><img alt="_images/tutorial_che_6-results2.png" src="_images/tutorial_che_6-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_6.xml">tutorial_che_6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_6-rt.xml">tutorial_che_6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_6.html">tutorial_che_6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_7">
<span id="chem-eng-example-7"></span><span id="tutorial-che-7"></span><h2>Chem. Eng. Example 7<a class="headerlink" href="#module-daetools.examples.tutorial_che_7" title="Permalink to this headline">¶</a></h2>
<p>Steady-state Plug Flow Reactor with energy balance and first order reaction:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>A -&gt; B
</pre></div>
</div>
<p>The problem is example 9.4.3 from the section 9.4 Nonisothermal Plug Flow Reactor
from the following book:</p>
<ul class="simple">
<li>Davis M.E., Davis R.J. (2003) Fundamentals of Chemical Reaction Engineering.
McGraw Hill, New York, US. ISBN 007245007X.</li>
</ul>
<p>The dimensionless concentration plot:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_7-results.png"><img alt="_images/tutorial_che_7-results.png" src="_images/tutorial_che_7-results.png" style="width: 500px;" /></a>
<p>The dimensionless temperature plot (adiabatic and nonisothermal cases):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_7-results2.png"><img alt="_images/tutorial_che_7-results2.png" src="_images/tutorial_che_7-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_7.xml">tutorial_che_7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_7-rt.xml">tutorial_che_7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_7.html">tutorial_che_7.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_8">
<span id="chem-eng-example-8"></span><span id="tutorial-che-8"></span><h2>Chem. Eng. Example 8<a class="headerlink" href="#module-daetools.examples.tutorial_che_8" title="Permalink to this headline">¶</a></h2>
<p>Model of a gas separation on a porous membrane with a metal support. The model employs
the Generalised Maxwell-Stefan (GMS) equations to predict fluxes and selectivities.
The membrane unit model represents a generic two-dimensonal model of a porous membrane
and consists of four models:</p>
<ul class="simple">
<li>Retentate compartment (isothermal axially dispersed plug flow)</li>
<li>Micro-porous membrane</li>
<li>Macro-porous support layer</li>
<li>Permeate compartment (the same transport phenomena as in the retentate compartment)</li>
</ul>
<p>The retentate compartment, the porous membrane, the support layer and the permeate
compartment are coupled via molar flux, temperature, pressure and gas composition at
the interfaces.
The model is described in the section 2.2 Membrane modelling of the following article:</p>
<ul class="simple">
<li>Nikolic D.D., Kikkinides E.S. (2015) Modelling and optimization of PSA/Membrane
separation processes. Adsorption 21(4):283-305.
<a class="reference external" href="http://doi.org/10.1007/s10450-015-9670-z">doi:10.1007/s10450-015-9670-z</a></li>
</ul>
<p>and in the original Krishna article:</p>
<ul class="simple">
<li>Krishna R. (1993) A unified approach to the modeling of intraparticle
diffusion in adsorption processes. Gas Sep. Purif. 7(2):91-104.
<a class="reference external" href="http://doi.org/10.1016/0950-4214(93)85006-H">doi:10.1016/0950-4214(93)85006-H</a></li>
</ul>
<p>This version is somewhat simplified for it only offers an extended Langmuir isotherm.
The Ideal Adsorption Solution theory (IAS) and the Real Adsorption Solution theory (RAS)
described in the articles are not implemented here.</p>
<p>The problem modelled is separation of hydrocarbons (CH4+C2H6) mixture on a zeolite
(silicalite-1) membrane with a metal support from the section &#8216;Binary mixture permeation&#8217;
of the following article:</p>
<ul class="simple">
<li>van de Graaf J.M., Kapteijn F., Moulijn J.A. (1999) Modeling Permeation of Binary
Mixtures Through Zeolite Membranes. AIChE J. 45:497–511.
<a class="reference external" href="http://doi.org/10.1002/aic.690450307">doi:10.1002/aic.690450307</a></li>
</ul>
<p>The CH4 and C2H6 fluxes, and CH4/C2H6 selectivity plots for two cases: GMS and GMS(Dij=∞),
1:1 mixture, and T = 303 K:</p>
<a class="reference internal image-reference" href="_images/tutorial_che_8-results.png"><img alt="_images/tutorial_che_8-results.png" src="_images/tutorial_che_8-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_8.xml">tutorial_che_8.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_8-rt.xml">tutorial_che_8-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_8.html">tutorial_che_8.py</a></td>
</tr>
<tr class="row-even"><td>Membrane unit</td>
<td><a class="reference external" href="./examples/membrane_unit.html">membrane_unit.py</a></td>
</tr>
<tr class="row-odd"><td>Variable types</td>
<td><a class="reference external" href="./examples/membrane_variable_types.html">membrane_variable_types.py</a></td>
</tr>
<tr class="row-even"><td>Membrane model</td>
<td><a class="reference external" href="./examples/membrane.html">membrane.py</a></td>
</tr>
<tr class="row-odd"><td>Support model</td>
<td><a class="reference external" href="./examples/support.html">support.py</a></td>
</tr>
<tr class="row-even"><td>In/out compartment</td>
<td><a class="reference external" href="./examples/compartment.html">compartment.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_9">
<span id="chem-eng-example-9"></span><span id="tutorial-che-9"></span><h2>Chem. Eng. Example 9<a class="headerlink" href="#module-daetools.examples.tutorial_che_9" title="Permalink to this headline">¶</a></h2>
<p>Chemical reaction network from the Dow Chemical Company described in the following article:</p>
<ul class="simple">
<li>Caracotsios M., Stewart W.E. (1985) Sensitivity analysis of initial value problems 
with mixed odes and algebraic equations. Computers &amp; Chemical Engineering 9(4):359-365.
<a class="reference external" href="https://doi.org/10.1016/0098-1354(85)85014-6">doi:10.1016/0098-1354(85)85014-6</a></li>
</ul>
<p>The sensitivity analysis is enabled and the sensitivity data can be obtained in two ways:</p>
<ul class="simple">
<li>Directly from the DAE solver in the user-defined Run function using the
DAESolver.SensitivityMatrix property.</li>
<li>From the data reporter as any ordinary variable.</li>
</ul>
<p>The concentrations plot (u1, u3, u4):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results1.png"><img alt="_images/tutorial_che_9-results1.png" src="_images/tutorial_che_9-results1.png" style="width: 500px;" /></a>
<p>The concentrations plot (u6, u8):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results2.png"><img alt="_images/tutorial_che_9-results2.png" src="_images/tutorial_che_9-results2.png" style="width: 500px;" /></a>
<p>The sensitivities plot (k2*du1/dk2, k2*du2/dk2, k2*du3/dk2, k2*du4/dk2, k2*du5/dk2):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_9-results3.png"><img alt="_images/tutorial_che_9-results3.png" src="_images/tutorial_che_9-results3.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_9.xml">tutorial_che_9.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_9-rt.xml">tutorial_che_9-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_9.html">tutorial_che_9.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_sa_1">
<span id="sensitivity-analysis-example-1"></span><span id="tutorial-sa-1"></span><h2>Sensitivity Analysis Example 1<a class="headerlink" href="#module-daetools.examples.tutorial_sa_1" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates calculation of the sensitivity of the results with respect
to the model parameters using forward sensitivity analysis method in DAE Tools.</p>
<p>This model has one state variable (T) and one degree of freedom (Qin).
Qin is set as a parameter for sensitivity analysis.</p>
<p>The integration of sensitivities per specified parameters is enabled and the 
sensitivities can be reported to the data reporter like any ordinary variable by 
setting the boolean property simulation.ReportSensitivities to True.</p>
<p>Raw sensitivity matrices can be saved into a specified directory using the 
simulation.SensitivityDataDirectory property (before a call to Initialize).
The sensitivity matrics are saved in .mmx coordinate format where the first
dimensions is Nparameters and second Nvariables: S[Np, Nvars].</p>
<p>The plot of the sensitivity of T per Qin:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_1-results.png"><img alt="_images/tutorial_sa_1-results.png" src="_images/tutorial_sa_1-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_1.xml">tutorial_sa_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_1-rt.xml">tutorial_sa_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_sa_1.html">tutorial_sa_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_sa_2">
<span id="sensitivity-analysis-example-2"></span><span id="tutorial-sa-2"></span><h2>Sensitivity Analysis Example 2<a class="headerlink" href="#module-daetools.examples.tutorial_sa_2" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the local derivative-based sensitivity analysis method 
available in DAE Tools.</p>
<p>The problem is adopted from the section 2.1 of the following article:</p>
<ul class="simple">
<li>A. Saltelli, M. Ratto, S. Tarantola, F. Campolongo.
Sensitivity Analysis for Chemical Models. Chem. Rev. (2005), 105(7):2811-2828.
<a class="reference external" href="http://dx.doi.org/10.1021/cr040659d">doi:10.1021/cr040659d</a></li>
</ul>
<p>The model is very simple and describes a simple reversible chemical reaction A &lt;-&gt; B, 
with reaction rates k1 and k_1 for the direct and inverse reactions, respectively.
The reaction rates are uncertain and are described by continuous random variables 
with known probability density functions. The standard deviation is 0.3 for k1 and
1 for k_1. The standard deviation of the concentration of the species A is
approximated using the following expression defined in the article:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>stddev(Ca)**2 = stddev(k1)**2 * (dCa/dk1)**2 + stddev(k_1)**2 * (dCa/dk_1)**2
</pre></div>
</div>
<p>The following derivative-based measures are used in the article:</p>
<ul>
<li><p class="first">Derivatives dCa/dk1 and dCa/dk_1 calculated using the forward sensitivity method</p>
</li>
<li><p class="first">Sigma normalised derivatives:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>S(k1)  = stddev(k1) / stddev(Ca) * dCa/dk1
S(k_1) = stddev(k_1)/ stddev(Ca) * dCa/dk_1
</pre></div>
</div>
</li>
</ul>
<p>The plot of the concentrations, derivatives and sigma normalised derivatives:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_2-results.png"><img alt="_images/tutorial_sa_2-results.png" src="_images/tutorial_sa_2-results.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_2.xml">tutorial_sa_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_2-rt.xml">tutorial_sa_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_sa_2.html">tutorial_sa_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_sa_3">
<span id="sensitivity-analysis-example-3"></span><span id="tutorial-sa-3"></span><h2>Sensitivity Analysis Example 3<a class="headerlink" href="#module-daetools.examples.tutorial_sa_3" title="Permalink to this headline">¶</a></h2>
<p>This tutorial illustrates the global variance-based sensitivity analysis methods
available in the <a class="reference external" href="https://github.com/SALib/SALib">SALib</a> python library.</p>
<p>The problem is adopted from the section 2.6 of the following article:</p>
<ul class="simple">
<li>A. Saltelli, M. Ratto, S. Tarantola, F. Campolongo.
Sensitivity Analysis for Chemical Models. Chem. Rev. (2005), 105(7):2811-2828.
<a class="reference external" href="http://dx.doi.org/10.1021/cr040659d">doi:10.1021/cr040659d</a></li>
</ul>
<p>The model describes a thermal analysis of a batch reactor, with exothermic 
reaction A -&gt; B. The model equations are written in dimensionless form.</p>
<p>Three global sensitivity analysis methods available in SALib are applied:</p>
<ul class="simple">
<li>Morris (Elementary Effect/Screening method)</li>
<li>Sobol (Variance-based methods)</li>
<li>FAST (Variance-based methods)</li>
</ul>
<p>Results from the sensitivity analysis:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>-------------------------------------------------------
       Morris (N = 510)
-------------------------------------------------------
    Param          mu        mu*   mu*_conf      Sigma
        B    0.367412   0.367412   0.114161   0.546276
    gamma   -0.040556   0.056616   0.021330   0.111878
      psi    0.311563   0.311563   0.103515   0.504398
  theta_a    0.326932   0.326932   0.102303   0.490423
  theta_0    0.021208   0.023524   0.016015   0.074062
-------------------------------------------------------

-------------------------------------------------------
       Sobol (N = 6144)
-------------------------------------------------------
    Param          S1    S1_conf         ST    ST_conf
        B    0.094110   0.078918   0.581930   0.154737
    gamma   -0.002416   0.012178   0.044354   0.027352
      psi    0.171043   0.087782   0.524579   0.142115
  theta_a    0.072535   0.042848   0.523394   0.165736
  theta_0    0.002340   0.004848   0.008173   0.005956

Parameter pairs          S2    S2_conf
        B/gamma    0.180427   0.160979
          B/psi    0.260689   0.171367
      B/theta_a    0.143261   0.154060
      B/theta_0    0.177129   0.156582
      gamma/psi    0.000981   0.027443
  gamma/theta_a    0.004956   0.036554
  gamma/theta_0   -0.009392   0.027390
    psi/theta_a    0.166155   0.172727
    psi/theta_0   -0.016434   0.129177
theta_a/theta_0    0.109057   0.127287
-------------------------------------------------------

---------------------------------
       FAST (N = 6150)
---------------------------------
    Param          S1         ST
        B    0.135984   0.559389
    gamma    0.000429   0.029026
      psi    0.171291   0.602461
  theta_a    0.144617   0.534116
  theta_0    0.000248   0.040741
---------------------------------
</pre></div>
</div>
<p>The scatter plot for the Morris method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_morris.png"><img alt="_images/tutorial_sa_3-scatter_morris.png" src="_images/tutorial_sa_3-scatter_morris.png" style="width: 800px;" /></a>
<p>The scatter plot for the Sobol method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_sobol.png"><img alt="_images/tutorial_sa_3-scatter_sobol.png" src="_images/tutorial_sa_3-scatter_sobol.png" style="width: 800px;" /></a>
<p>The scatter plot for the FAST method:</p>
<a class="reference internal image-reference" href="_images/tutorial_sa_3-scatter_fast.png"><img alt="_images/tutorial_sa_3-scatter_fast.png" src="_images/tutorial_sa_3-scatter_fast.png" style="width: 800px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_3.xml">tutorial_sa_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_sa_3-rt.xml">tutorial_sa_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_sa_3.html">tutorial_sa_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_dae_1">
<span id="opencs-example-dae-1"></span><span id="tutorial-opencs-dae-1"></span><h2>OpenCS Example DAE 1<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_dae_1" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of IDAS idasAkzoNob_dns example.
The chemical kinetics problem with 6 non-linear diff. equations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dy1_dt</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">r3</span> <span class="o">+</span> <span class="n">r4</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dy2_dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r4</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">r5</span> <span class="o">-</span> <span class="n">Fin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dy3_dt</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dy4_dt</span> <span class="o">+</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r4</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dy5_dt</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">r3</span> <span class="o">-</span> <span class="n">r5</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="n">Ks</span><span class="o">*</span><span class="n">y1</span><span class="o">*</span><span class="n">y4</span> <span class="o">-</span> <span class="n">y6</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>where:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">r1</span>  <span class="o">=</span> <span class="n">k1</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>
<span class="n">r2</span>  <span class="o">=</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">y4</span>
<span class="n">r3</span>  <span class="o">=</span> <span class="n">k2</span><span class="o">/</span><span class="n">K</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y5</span>
<span class="n">r4</span>  <span class="o">=</span> <span class="n">k3</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y4</span> <span class="o">*</span> <span class="n">y4</span>
<span class="n">r5</span>  <span class="o">=</span> <span class="n">k4</span> <span class="o">*</span> <span class="n">y6</span> <span class="o">*</span> <span class="n">y6</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>
<span class="n">Fin</span> <span class="o">=</span> <span class="n">klA</span> <span class="o">*</span> <span class="p">(</span><span class="n">pCO2</span><span class="o">/</span><span class="n">H</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
</div>
<p>The system is stiff.
The original results are in tutorial_opencs_dae_1.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_1.html">tutorial_opencs_dae_1.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>DAE Tools model</td>
<td><a class="reference external" href="./examples/tutorial_opencs_daetools_1.html">tutorial_opencs_daetools_1.py</a></td>
</tr>
<tr class="row-even"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_1.csv">tutorial_opencs_dae_1.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_dae_2">
<span id="opencs-example-dae-2"></span><span id="tutorial-opencs-dae-2"></span><h2>OpenCS Example DAE 2<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_dae_2" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of DAE Tools tutorial1.py example.
A simple heat conduction problem: conduction through a very thin, rectangular copper plate:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">*</span> <span class="n">cp</span> <span class="o">*</span> <span class="n">dT</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">[</span><span class="n">d2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dx2</span> <span class="o">+</span> <span class="n">d2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">dy2</span><span class="p">];</span>  <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">),</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>
</pre></div>
</div>
<p>Two-dimensional Cartesian grid (x,y) of 20 x 20 elements.
The original results are in tutorial_opencs_dae_2.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_2.html">tutorial_opencs_dae_2.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_2.csv">tutorial_opencs_dae_2.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_dae_3">
<span id="opencs-example-dae-3"></span><span id="tutorial-opencs-dae-3"></span><h2>OpenCS Example DAE 3<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_dae_3" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of IDAS idasBruss_kry_bbd_p example.
The PDE system is a two-species time-dependent PDE known as
Brusselator PDE and models a chemically reacting system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">du</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">eps1</span><span class="p">(</span><span class="n">d2u</span><span class="o">/</span><span class="n">dx2</span>  <span class="o">+</span> <span class="n">d2u</span><span class="o">/</span><span class="n">dy2</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="n">v</span> <span class="o">-</span> <span class="p">(</span><span class="n">B</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="n">u</span> <span class="o">+</span> <span class="n">A</span>
<span class="n">dv</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">eps2</span><span class="p">(</span><span class="n">d2v</span><span class="o">/</span><span class="n">dx2</span>  <span class="o">+</span> <span class="n">d2v</span><span class="o">/</span><span class="n">dy2</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="n">v</span> <span class="o">+</span> <span class="n">Bu</span>
</pre></div>
</div>
<p>Boundary conditions: Homogenous Neumann.
Initial Conditions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t0</span><span class="p">)</span> <span class="o">=</span> <span class="n">u0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">1</span>  <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
<span class="n">v</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t0</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">-</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<p>The PDEs are discretized by central differencing on a uniform (Nx, Ny) grid.
The model is described in:</p>
<ul class="simple">
<li>R. Serban and A. C. Hindmarsh. CVODES, the sensitivity-enabled ODE solver in SUNDIALS.
In Proceedings of the 5th International Conference on Multibody Systems,
Nonlinear Dynamics and Control, Long Beach, CA, 2005. ASME.</li>
<li>M. R. Wittman. Testing of PVODE, a Parallel ODE Solver.
Technical Report UCRL-ID-125562, LLNL, August 1996.</li>
</ul>
<p>The original results are in tutorial_opencs_dae_3.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_3.html">tutorial_opencs_dae_3.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_dae_3.csv">tutorial_opencs_dae_3.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_ode_1">
<span id="opencs-example-ode-1"></span><span id="tutorial-opencs-ode-1"></span><h2>OpenCS Example ODE 1<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_ode_1" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of CVodes cvsRoberts_dns example.
The Roberts chemical kinetics problem with 3 rate equations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dy1</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04</span><span class="o">*</span><span class="n">y1</span> <span class="o">+</span> <span class="mf">1.e4</span><span class="o">*</span><span class="n">y2</span><span class="o">*</span><span class="n">y3</span>
<span class="n">dy2</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span>  <span class="mf">0.04</span><span class="o">*</span><span class="n">y1</span> <span class="o">-</span> <span class="mf">1.e4</span><span class="o">*</span><span class="n">y2</span><span class="o">*</span><span class="n">y3</span> <span class="o">-</span> <span class="mf">3.e7</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">dy3</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span>  <span class="mf">3.e7</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>The problem is simulated for 4000 s, with the initial conditions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">y1</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">y3</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The problem is stiff.
The original results are in tutorial_opencs_ode_1.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_1.html">tutorial_opencs_ode_1.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_1.csv">tutorial_opencs_ode_1.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_ode_2">
<span id="opencs-example-ode-2"></span><span id="tutorial-opencs-ode-2"></span><h2>OpenCS Example ODE 2<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_ode_2" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of CVodes cvsAdvDiff_bnd example.
The problem is simple advection-diffusion in 2-D:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">du</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">d2u</span><span class="o">/</span><span class="n">dx2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="n">du</span><span class="o">/</span><span class="n">dx</span> <span class="o">+</span> <span class="n">d2u</span><span class="o">/</span><span class="n">dy2</span>
</pre></div>
</div>
<p>on the rectangle:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>and simulated for 1 s.
Homogeneous Dirichlet boundary conditions are imposed, with the initial conditions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="n">xy</span><span class="p">)</span>
</pre></div>
</div>
<p>The PDE is discretized on a uniform Nx+2 by Ny+2 grid with central differencing.
The boundary points are eliminated leaving an ODE system of size Nx*Ny.
The original results are in tutorial_opencs_ode_2.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_2.html">tutorial_opencs_ode_2.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_2.csv">tutorial_opencs_ode_2.csv</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_opencs_ode_3">
<span id="opencs-example-ode-3"></span><span id="tutorial-opencs-ode-3"></span><h2>OpenCS Example ODE 3<a class="headerlink" href="#module-daetools.examples.tutorial_opencs_ode_3" title="Permalink to this headline">¶</a></h2>
<p>Reimplementation of CVodes cvsDiurnal_kry example.
2-species diurnal kinetics advection-diffusion PDE system in 2D:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">Kh</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">dc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="o">+</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">dy</span><span class="p">)(</span><span class="n">Kv</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">dc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">dy</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ri</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">t</span><span class="p">),</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
</pre></div>
</div>
<p>where:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">R1</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">q1</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c3</span> <span class="o">-</span> <span class="n">q2</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">q3</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">q4</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">c2</span>
<span class="n">R2</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span>  <span class="n">q1</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c3</span> <span class="o">-</span> <span class="n">q2</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="n">q4</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">c2</span>
<span class="n">Kv</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">Kv0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Kh, V, Kv0, q1, q2, and c3 are constants, and q3(t) and q4(t) vary diurnally.
The problem is posed on the square:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">20</span> <span class="p">(</span><span class="n">km</span><span class="p">)</span>
<span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="p">(</span><span class="n">km</span><span class="p">)</span>
</pre></div>
</div>
<p>with homogeneous Neumann boundary conditions, and integrated for 86400 sec (1 day).
The PDE system is discretised using the central differences on a uniform 10 x 10 mesh.
The original results are in tutorial_opencs_ode_3.csv file.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_3.html">tutorial_opencs_ode_3.py</a></td>
</tr>
<tr class="row-even"><td>Auxiliary functions</td>
<td><a class="reference external" href="./examples/tutorial_opencs_aux.html">tutorial_opencs_aux.py</a></td>
</tr>
<tr class="row-odd"><td>The original results</td>
<td><a class="reference external" href="./examples/tutorial_opencs_ode_3.csv">tutorial_opencs_ode_3.csv</a></td>
</tr>
</tbody>
</table>
<p>The implementations of the <a class="reference external" href="http://www.mcs.anl.gov/~more/cops">COPS</a> tests differ from the
original ones in following:</p>
<ul class="simple">
<li>The Direct Sequential Approach has been applied while the original tests use
the Direct Simultaneous Approach</li>
<li>The analytical sensitivity Hessian matrix is not available. The limited memory
Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) algorithm from IPOPT is used.</li>
</ul>
<p>As a consequence, the results slightly differ from the published results.
In addition, the solver options should be tuned to achieve faster convergence.</p>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_1">
<span id="chem-eng-optimisation-example-1"></span><span id="tutorial-che-opt-1"></span><h2>Chem. Eng. Optimisation Example 1<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_1" title="Permalink to this headline">¶</a></h2>
<p>Optimisation of the CSTR model and Van de Vusse reactions given in tutorial_che_1:</p>
<p>Not fully implemented yet.</p>
<p>Reference: G.A. Ridlehoover, R.C. Seagrave. Optimization of Van de Vusse Reaction Kinetics
Using Semibatch Reactor Operation, Ind. Eng. Chem. Fundamen. 1973;12(4):444-447.
<a class="reference external" href="https://doi.org/10.1021/i160048a700">doi:10.1021/i160048a700</a></p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_1.xml">tutorial_che_opt_1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_1-rt.xml">tutorial_che_opt_1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_1.html">tutorial_che_opt_1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_2">
<span id="chem-eng-optimisation-example-2"></span><span id="tutorial-che-opt-2"></span><h2>Chem. Eng. Optimisation Example 2<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_2" title="Permalink to this headline">¶</a></h2>
<p>COPS test 5: Isomerization of α-pinene (parameter estimation of a dynamic system).</p>
<p>Very slow convergence.</p>
<p>Determine the reaction coefficients in the thermal isometrization of α-pinene (y1) to
dipentene (y2) and allo-ocimen (y3) which in turn produces α- and β-pyronene (y4)
and a dimer (y5).</p>
<p>Reference: Benchmarking Optimization Software with COPS 3.0, Mathematics and Computer
Science Division, Argonne National Laboratory, Technical Report ANL/MCS-273, 2004.
<a class="reference external" href="http://www.mcs.anl.gov/~more/cops/cops3.pdf">PDF</a></p>
<p>Experimental data taken from:  Rocha A.M.A.C., Martins M.C., Costa M.F.P.,
Fernandes, E.M.G.P. (2016) Direct sequential based firefly algorithm for the α-pinene
isomerization problem. 16th International Conference on Computational Science and Its
Applications, ICCSA 2016, Beijing, China.
<a class="reference external" href="http://doi.org/10.1007/978-3-319-42085-1_30">doi:10.1007/978-3-319-42085-1_30</a></p>
<p>Run options:</p>
<ul class="simple">
<li>Simulation with optimal parameters: python tutorial_che_opt_2.py simulation</li>
<li>Parameter estimation console run:   python tutorial_che_opt_2.py console</li>
<li>Parameter estimation GUI run:       python tutorial_che_opt_2.py gui</li>
</ul>
<p>Currently, the parameter estimation results are (solver options/scaling should be tuned):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Fobj  57.83097
p1    5.63514e-05
p2    2.89711e-05
p3    1.39979e-05
p4   18.67874e-05
p5    2.23770e-05
</pre></div>
</div>
<p>The concentration plots (for optimal &#8216;p&#8217; from the literature):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_2-results.png"><img alt="_images/tutorial_che_opt_2-results.png" src="_images/tutorial_che_opt_2-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_2.xml">tutorial_che_opt_2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_2-rt.xml">tutorial_che_opt_2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_2.html">tutorial_che_opt_2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_3">
<span id="chem-eng-optimisation-example-3"></span><span id="tutorial-che-opt-3"></span><h2>Chem. Eng. Optimisation Example 3<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_3" title="Permalink to this headline">¶</a></h2>
<p>COPS test 6: Marine Population Dynamics. (Not working properly)</p>
<p>Given estimates of the abundance of the population of a marine species at each stage
(for example, nauplius, juvenile, adult) as a function of time, determine stage specific
growth and mortality rates.</p>
<p>Reference: Benchmarking Optimization Software with COPS 3.0, Mathematics and Computer
Science Division, Argonne National Laboratory, Technical Report ANL/MCS-273, 2004.
<a class="reference external" href="http://www.mcs.anl.gov/~more/cops/cops3.pdf">PDF</a></p>
<p>Experimental data generated following the procedure described in the COPS test.</p>
<p>Run options:</p>
<ul class="simple">
<li>Simulation with optimal parameters: python tutorial_che_opt_3.py simulation</li>
<li>Parameter estimation console run:   python tutorial_che_opt_3.py console</li>
<li>Parameter estimation GUI run:       python tutorial_che_opt_3.py gui</li>
</ul>
<p>Currently, the parameter estimation results are (suboptimal results obtained, solver
options/scaling should be tuned):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Fobj =  1.920139e+8
m(0)    3.358765e-01
m(1)    4.711709e-01
m(2)    1.120524e-01
m(3)    8.509170e-02
m(4)    9.683579e-02
m(5)    1.919142e-01
m(6)    2.418778e-01
m(7)    2.421000e-01
g(0)    1.152995e+00
g(1)    7.529383e-01
g(2)    5.024174e-01
g(3)    5.704327e-01
g(4)    4.180333e-01
g(5)    3.185407e-01
g(6)    2.250250e-01
</pre></div>
</div>
<p>The distribution moments 1,2,5,6 plots (for optimal results from the literature):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_3-results.png"><img alt="_images/tutorial_che_opt_3-results.png" src="_images/tutorial_che_opt_3-results.png" style="width: 500px;" /></a>
<p>The distribution moments 3,4,7,8 plots (for optimal results from the literature):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_3-results2.png"><img alt="_images/tutorial_che_opt_3-results2.png" src="_images/tutorial_che_opt_3-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_3.xml">tutorial_che_opt_3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_3-rt.xml">tutorial_che_opt_3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_3.html">tutorial_che_opt_3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_4">
<span id="chem-eng-optimisation-example-4"></span><span id="tutorial-che-opt-4"></span><h2>Chem. Eng. Optimisation Example 4<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_4" title="Permalink to this headline">¶</a></h2>
<p>COPS test 12: Catalytic Cracking of Gas Oil.</p>
<p>Determine the reaction coefficients for the catalytic cracking of gas oil into gas and other
byproducts.</p>
<p>Reference: Benchmarking Optimization Software with COPS 3.0, Mathematics and Computer
Science Division, Argonne National Laboratory, Technical Report ANL/MCS-273, 2004.
<a class="reference external" href="http://www.mcs.anl.gov/~more/cops/cops3.pdf">PDF</a></p>
<p>Experimental data generated following the procedure described in the COPS test.</p>
<p>Run options:</p>
<ul class="simple">
<li>Simulation with optimal parameters: python tutorial_che_opt_4.py simulation</li>
<li>Parameter estimation console run:   python tutorial_che_opt_4.py console</li>
<li>Parameter estimation GUI run:       python tutorial_che_opt_4.py gui</li>
</ul>
<p>Currently, the parameter estimation results are (solver options/scaling should be tuned):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Fobj = 4.841995e-3
p1   = 10.95289
p2   =  7.70601
p3   =  2.89625
</pre></div>
</div>
<p>The concentration plots (for optimal &#8216;p&#8217; from the literature):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_4-results.png"><img alt="_images/tutorial_che_opt_4-results.png" src="_images/tutorial_che_opt_4-results.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_4.xml">tutorial_che_opt_4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_4-rt.xml">tutorial_che_opt_4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_4.html">tutorial_che_opt_4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_5">
<span id="chem-eng-optimisation-example-5"></span><span id="tutorial-che-opt-5"></span><h2>Chem. Eng. Optimisation Example 5<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_5" title="Permalink to this headline">¶</a></h2>
<p>COPS test 13: Methanol to Hydrocarbons.</p>
<p>Determine the reaction coefficients for the conversion of methanol into various hydrocarbons.</p>
<p>Reference: Benchmarking Optimization Software with COPS 3.0, Mathematics and Computer
Science Division, Argonne National Laboratory, Technical Report ANL/MCS-273, 2004.
<a class="reference external" href="http://www.mcs.anl.gov/~more/cops/cops3.pdf">PDF</a></p>
<p>Experimental data generated following the procedure described in the COPS test.</p>
<p>Run options:</p>
<ul class="simple">
<li>Simulation with optimal parameters: python tutorial_che_opt_5.py simulation</li>
<li>Parameter estimation console run:   python tutorial_che_opt_5.py console</li>
<li>Parameter estimation GUI run:       python tutorial_che_opt_5.py gui</li>
</ul>
<p>Currently, the parameter estimation results are (solver options/scaling should be tuned):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Fobj = 1.274997e-2
p1 = 2.641769
p2 = 1.466245
p3 = 1.884254
p4 = 1.023885
p5 = 0.471067
</pre></div>
</div>
<p>The concentration plots (for optimal &#8216;p&#8217; from the literature):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_5-results.png"><img alt="_images/tutorial_che_opt_5-results.png" src="_images/tutorial_che_opt_5-results.png" style="width: 500px;" /></a>
<p>The concentration plots (for optimal &#8216;p&#8217; from this optimisation):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_5-results2.png"><img alt="_images/tutorial_che_opt_5-results2.png" src="_images/tutorial_che_opt_5-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_5.xml">tutorial_che_opt_5.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_5-rt.xml">tutorial_che_opt_5-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_5.html">tutorial_che_opt_5.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.tutorial_che_opt_6">
<span id="chem-eng-optimisation-example-6"></span><span id="tutorial-che-opt-6"></span><h2>Chem. Eng. Optimisation Example 6<a class="headerlink" href="#module-daetools.examples.tutorial_che_opt_6" title="Permalink to this headline">¶</a></h2>
<p>COPS optimisation test 14: Catalyst Mixing.</p>
<p>Determine the optimal mixing policy of two catalysts along the length of a tubular
plug flow reactor involving several reactions.</p>
<p>Reference: Benchmarking Optimization Software with COPS 3.0, Mathematics and Computer
Science Division, Argonne National Laboratory, Technical Report ANL/MCS-273, 2004.
<a class="reference external" href="http://www.mcs.anl.gov/~more/cops/cops3.pdf">PDF</a></p>
<p>In DAE Tools numerical solution of dynamic optimisation problems is obtained using
the Direct Sequential Approach where, given a set of values for the decision variables,
the system of ODEs are accurately integrated over the entire time interval using specific
numerical integration formulae so that the objective functional can be evaluated.
Therefore, the differential equations are satisfied at each iteration of the
optimisation procedure.</p>
<p>In the COPS test, the problem is solved using the Direct Simultaneous Approach where
the equations that result from a discretisation of an ODE model using orthogonal
collocation on finite elements (OCFE), are incorporated directly into the optimisation
problem, and the combined problem is then solved using a large-scale optimisation strategy.</p>
<p>The results: fobj = -4.79479E-2 (for Nh = 100) and -4.78676E-02 (for Nh = 200).</p>
<p>The control variables plot (for Nh = 100):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_6-results.png"><img alt="_images/tutorial_che_opt_6-results.png" src="_images/tutorial_che_opt_6-results.png" style="width: 500px;" /></a>
<p>The control variables plot (for Nh = 200):</p>
<a class="reference internal image-reference" href="_images/tutorial_che_opt_6-results2.png"><img alt="_images/tutorial_che_opt_6-results2.png" src="_images/tutorial_che_opt_6-results2.png" style="width: 500px;" /></a>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_6.xml">tutorial_che_opt_6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_6-rt.xml">tutorial_che_opt_6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/tutorial_che_opt_6.html">tutorial_che_opt_6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial1">
<span id="optimisation-tutorial-1"></span><span id="opt-tutorial1"></span><h2>Optimisation tutorial 1<a class="headerlink" href="#module-daetools.examples.opt_tutorial1" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces IPOPT NLP solver, its setup and options.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial1.xml">opt_tutorial1.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial1-rt.xml">opt_tutorial1-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial1.html">opt_tutorial1.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial2">
<span id="optimisation-tutorial-2"></span><span id="opt-tutorial2"></span><h2>Optimisation tutorial 2<a class="headerlink" href="#module-daetools.examples.opt_tutorial2" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces Bonmin MINLP solver, its setup and options.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial2.xml">opt_tutorial2.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial2-rt.xml">opt_tutorial2-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial2.html">opt_tutorial2.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial3">
<span id="optimisation-tutorial-3"></span><span id="opt-tutorial3"></span><h2>Optimisation tutorial 3<a class="headerlink" href="#module-daetools.examples.opt_tutorial3" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces NLOPT NLP solver, its setup and options.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial3.xml">opt_tutorial3.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial3-rt.xml">opt_tutorial3-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial3.html">opt_tutorial3.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial4">
<span id="optimisation-tutorial-4"></span><span id="opt-tutorial4"></span><h2>Optimisation tutorial 4<a class="headerlink" href="#module-daetools.examples.opt_tutorial4" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows the interoperability between DAE Tools and 3rd party optimization 
software (scipy.optimize) used to minimize the Rosenbrock function.</p>
<p>DAE Tools simulation is used to calculate the objective function and its gradients,
while scipy.optimize.fmin function (Nelder-Mead Simplex algorithm) to find the 
minimum of the Rosenbrock function.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial4.xml">opt_tutorial4.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial4-rt.xml">opt_tutorial4-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial4.html">opt_tutorial4.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial5">
<span id="optimisation-tutorial-5"></span><span id="opt-tutorial5"></span><h2>Optimisation tutorial 5<a class="headerlink" href="#module-daetools.examples.opt_tutorial5" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows the interoperability between DAE Tools and 3rd party optimization 
software (scipy.optimize) used to fit the simple function with experimental data.</p>
<p>DAE Tools simulation object is used to calculate the objective function and its gradients,
while scipy.optimize.leastsq function (a wrapper around MINPACK’s lmdif and lmder)
implementing Levenberg-Marquardt algorithm is used to estimate the parameters.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial4.xml">opt_tutorial5.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial5-rt.xml">opt_tutorial5-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial5.html">opt_tutorial5.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial6">
<span id="optimisation-tutorial-6"></span><span id="opt-tutorial6"></span><h2>Optimisation tutorial 6<a class="headerlink" href="#module-daetools.examples.opt_tutorial6" title="Permalink to this headline">¶</a></h2>
<p>daeMinpackLeastSq module test.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial6.xml">opt_tutorial6.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial6-rt.xml">opt_tutorial6-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial6.html">opt_tutorial6.py</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-daetools.examples.opt_tutorial7">
<span id="optimisation-tutorial-7"></span><span id="opt-tutorial7"></span><h2>Optimisation tutorial 7<a class="headerlink" href="#module-daetools.examples.opt_tutorial7" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces monitoring optimization progress.</p>
<p class="rubric">Files</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Model report</td>
<td><a class="reference external" href="./examples/opt_tutorial7.xml">opt_tutorial7.xml</a></td>
</tr>
<tr class="row-even"><td>Runtime model report</td>
<td><a class="reference external" href="./examples/opt_tutorial7-rt.xml">opt_tutorial7-rt.xml</a></td>
</tr>
<tr class="row-odd"><td>Source code</td>
<td><a class="reference external" href="./examples/opt_tutorial7.html">opt_tutorial7.py</a></td>
</tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/tutorials-all.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2008-2019, Dragan Nikolic.<br/>
      Last updated on Mar 29, 2019.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52277546-1', 'daetools.com');
  ga('send', 'pageview');
</script>


  </body>
</html>